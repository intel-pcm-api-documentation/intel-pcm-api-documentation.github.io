<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Intel(r) Performance Counter Monitor: cpucounters.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Intel(r) Performance Counter Monitor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cpucounters.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cpucounters_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">Copyright (c) 2009-2013, Intel Corporation</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">All rights reserved.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    * Neither the name of Intel Corporation nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// written by Roman Dementiev</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//            Thomas Willhalm</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifndef CPUCOUNTERS_HEADER</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define CPUCOUNTERS_HEADER</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#define INTEL_PCM_VERSION &quot;V2.7 ($Format:%ci ID=%h$)&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef INTELPCM_API</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define INTELPCM_API</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="types_8h.html">types.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="msr_8h.html">msr.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pci_8h.html">pci.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="client__bw_8h.html">client_bw.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="width__extender_8h.html">width_extender.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#ifdef PCM_USE_PERF</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;linux/perf_event.h&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;sys/syscall.h&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#define PCM_PERF_COUNT_HW_REF_CPU_CYCLES (9)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifndef _MSC_VER</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#define NOMINMAX</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;semaphore.h&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">class </span><a class="code" href="classSystemCounterState.html">SystemCounterState</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">class </span><a class="code" href="classSocketCounterState.html">SocketCounterState</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">class </span><a class="code" href="classCoreCounterState.html">CoreCounterState</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">class </span><a class="code" href="classBasicCounterState.html">BasicCounterState</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">class </span><a class="code" href="classServerUncorePowerState.html">ServerUncorePowerState</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">        CPU performance monitoring routines</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">        A set of performance monitoring routines for recent Intel CPUs</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structTopologyEntry.html">   70</a></span>&#160;<span class="keyword">struct </span>INTELPCM_API <a class="code" href="structTopologyEntry.html">TopologyEntry</a> <span class="comment">// decribes a core</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    int32 os_id;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    int32 socket;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    int32 core_id;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="structTopologyEntry.html">TopologyEntry</a>() : os_id(-1), socket(-1), core_id(-1) { }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;};</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html">   80</a></span>&#160;<span class="keyword">class </span><a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">int</span> bus, groupnr;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="classPciHandleM.html">PciHandleM</a> ** imcHandles;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    uint32 num_imc_channels;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classPciHandleM.html">PciHandleM</a> ** qpiLLHandles;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    uint32 num_qpi_ports;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    std::vector&lt;uint64&gt; qpi_speed;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    uint32 num_imc;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    uint32 MCX_CHY_REGISTER_DEV_ADDR[2][4];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    uint32 MCX_CHY_REGISTER_FUNC_ADDR[2][4];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">static</span> std::vector&lt;std::pair&lt;uint32,uint32&gt; &gt; socket2bus;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">void</span> initSocket2Bus();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>();                 <span class="comment">// forbidden</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>(<a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a> &amp;); <span class="comment">// forbidden</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classPciHandleM.html">PciHandleM</a> * createIntelPerfMonDevice(uint32 groupnr, uint32 bus, uint32 dev, uint32 func, <span class="keywordtype">bool</span> checkVendor = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>(uint32 socket_, <a class="code" href="classPCM.html">PCM</a> * pcm);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classServerPCICFGUncore.html#acd6e859dd5eaaadf97d2c59ae70ac4a7">program</a>();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#a214de12b52f2d5a7c9c33701dfc8eb85">getImcReads</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#a089f11fc46ab836884cc31b5b4ac08e3">getImcWrites</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#abaeb0a56fa35ecbd0c092b733a1f923b">getIncomingDataFlits</a>(uint32 port);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#a0c49b159e5bdf999d3c14cfcba51136b">getOutgoingDataNonDataFlits</a>(uint32 port);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classServerPCICFGUncore.html#af53af91d9172cd124e455e500d6c5622">program_power_metrics</a>(<span class="keywordtype">int</span> mc_profile);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#ae5bc4e8e1003ed74fdd3c641e6ac78a5">getQPIClocks</a>(uint32 port);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#a7aaff7ae03c8189de550215cef3b39f7">getQPIL0pTxCycles</a>(uint32 port);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#aa0ac63963af6105dd066f09beb923d17">getQPIL1Cycles</a>(uint32 port);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#a3b218ad26a3c6411754ed177427b2a80">getDRAMClocks</a>(uint32 channel);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#ad66687e98d1b74c145b79fedefc07d15">getMCCounter</a>(uint32 channel, uint32 counter);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#abcd9990a39fb245bb552e6cae4922305">getQPILLCounter</a>(uint32 port, uint32 counter);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classServerPCICFGUncore.html#ad4bda64cc17432d44ee8e380a735b795">freezeCounters</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classServerPCICFGUncore.html#a379962b379f637f3b752f7fb4666c7e7">unfreezeCounters</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#a42a0e1343ab38371279bf9def8123419">computeQPISpeed</a>(<span class="keyword">const</span> uint32 ref_core, <span class="keyword">const</span> <span class="keywordtype">int</span> cpumodel);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classServerPCICFGUncore.html#a91352764d2ab70889388f61d48852694">enableJKTWorkaround</a>(<span class="keywordtype">bool</span> enable);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    </div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#ac8dc5ffa64ffebcd21b1d5882ab1fe16">  160</a></span>&#160;    uint32 <a class="code" href="classServerPCICFGUncore.html#ac8dc5ffa64ffebcd21b1d5882ab1fe16">getNumQPIPorts</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> num_qpi_ports; }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#af5c42a5eb97b97f17a3cb0010bd04642">  163</a></span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#af5c42a5eb97b97f17a3cb0010bd04642">getQPILinkSpeed</a>(<span class="keyword">const</span> uint32 linkNr)<span class="keyword"> const </span>{ </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> qpi_speed.empty() ? 0 : qpi_speed[linkNr]; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#a6746ae55dfb998b5e6f5e50cbe6fb957">  168</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classServerPCICFGUncore.html#a6746ae55dfb998b5e6f5e50cbe6fb957">reportQPISpeed</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        std::cerr.precision(1);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        std::cerr &lt;&lt; std::fixed;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">for</span> (uint32 i=0; i&lt;qpi_speed.size(); ++i)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          std::cerr &lt;&lt; <span class="stringliteral">&quot;Max QPI link &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; speed: &quot;</span> &lt;&lt; qpi_speed[i] / (1e9) &lt;&lt; <span class="stringliteral">&quot; GBytes/second (&quot;</span> &lt;&lt; qpi_speed[i] / (2e9) &lt;&lt; <span class="stringliteral">&quot; GT/second)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#acf1af9c95ce0d0d0cd8940a38866a639">  177</a></span>&#160;    uint32 <a class="code" href="classServerPCICFGUncore.html#acf1af9c95ce0d0d0cd8940a38866a639">getNumMC</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> num_imc; }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#a52ceae2a7ca82345dbf0b9333ca12038">  180</a></span>&#160;    uint32 <a class="code" href="classServerPCICFGUncore.html#a52ceae2a7ca82345dbf0b9333ca12038">getNumMCChannels</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> num_imc_channels; }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;};</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classPCIeCounterState.html">  183</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPCIeCounterState.html">PCIeCounterState</a></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classPCIeCounterState.html#a3dfbc795387d801541439b6c035c7b8c">getNumberOfEvents</a>(<a class="code" href="classPCIeCounterState.html">PCIeCounterState</a> before, <a class="code" href="classPCIeCounterState.html">PCIeCounterState</a> after);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    uint64 data;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classPCIeCounterState.html">PCIeCounterState</a>(): data(0)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classPCIeCounterState.html">PCIeCounterState</a>() {}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;};</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#ifndef HACK_TO_REMOVE_DUPLICATE_ERROR </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::allocator&lt;TopologyEntry&gt;;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::vector&lt;TopologyEntry&gt;;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::allocator&lt;CounterWidthExtender*&gt;;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::vector&lt;CounterWidthExtender*&gt;;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::allocator&lt;uint32&gt;;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::vector&lt;uint32&gt;;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>INTELPCM_API std::allocator&lt;char&gt;;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="classPCM.html">  210</a></span>&#160;<span class="keyword">class </span>INTELPCM_API <a class="code" href="classPCM.html">PCM</a></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classBasicCounterState.html">BasicCounterState</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classPCM.html">PCM</a>();     <span class="comment">// forbidden to call directly because it is a singleton</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    int32 cpu_family;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    int32 cpu_model, original_cpu_model;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    int32 threads_per_core;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    int32 num_cores;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    int32 num_sockets;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    int32 num_phys_cores_per_socket;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    int32 num_online_cores;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    uint32 core_gen_counter_num_max;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    uint32 core_gen_counter_num_used;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    uint32 core_gen_counter_width;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    uint32 core_fixed_counter_num_max;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    uint32 core_fixed_counter_num_used;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    uint32 core_fixed_counter_width;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    uint32 uncore_gen_counter_num_max;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    uint32 uncore_gen_counter_num_used;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    uint32 uncore_gen_counter_width;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    uint32 uncore_fixed_counter_num_max;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    uint32 uncore_fixed_counter_num_used;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    uint32 uncore_fixed_counter_width;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    int32 perfmon_version;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    int32 perfmon_config_anythread;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    uint64 nominal_frequency;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    uint64 max_qpi_speed; <span class="comment">// in GBytes/second</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    int32 pkgThermalSpecPower, pkgMinimumPower, pkgMaximumPower;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    std::vector&lt;TopologyEntry&gt; topology;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    std::string errorMessage;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">static</span> <a class="code" href="classPCM.html">PCM</a> * instance;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">bool</span> allow_multiple_instances;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">bool</span> programmed_pmu;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> ** MSR;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a> ** server_pcicfg_uncore;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    uint32 PCU_MSR_PMON_BOX_CTL_ADDR, PCU_MSR_PMON_CTRX_ADDR[4];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">double</span> joulesPerEnergyUnit;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    std::vector&lt;CounterWidthExtender*&gt; snb_energy_status;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    std::vector&lt;CounterWidthExtender*&gt; jkt_dram_energy_status;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classClientBW.html">ClientBW</a> * clientBW;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classCounterWidthExtender.html">CounterWidthExtender</a> * clientImcReads;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classCounterWidthExtender.html">CounterWidthExtender</a> * clientImcWrites;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classCounterWidthExtender.html">CounterWidthExtender</a> * clientIoRequests;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">bool</span> disable_JKT_workaround;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">bool</span> blocked; <span class="comment">// track if time-driven counter update is running or not: PCM is blocked</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    uint64 * coreCStateMsr; <span class="comment">// MSR addresses of core C-state free-running counters</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    uint64 * pkgCStateMsr; <span class="comment">// MSR addresses of package C-state free-running counters</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">enum</span> { MAX_C_STATE = 10 }; <span class="comment">// max C-state on Intel architecture</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">  270</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">isCoreCStateResidencySupported</a>(<span class="keywordtype">int</span> state)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <span class="keywordflow">if</span> (state == 0 || state == 1)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;              <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordflow">return</span> (coreCStateMsr != NULL &amp;&amp; state &lt;= MAX_C_STATE &amp;&amp; coreCStateMsr[state] != 0);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classPCM.html#aad05d8a2f383ad41d25892175373b613">  279</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#aad05d8a2f383ad41d25892175373b613">isPackageCStateResidencySupported</a>(<span class="keywordtype">int</span> state)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">return</span> (pkgCStateMsr != NULL &amp;&amp; state &lt;= MAX_C_STATE &amp;&amp; pkgCStateMsr[state] != 0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#aaab4b857581f55723fc3959cf6c8cd91">setOutput</a>(<span class="keyword">const</span> std::string filename);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#af8bcd9d89ee64d8effdf968132f3b842">restoreOutput</a>();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// Arguments:</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">//  -- 1 - program is running</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//  -- 0 -pgram is sleeping</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classPCM.html#adb5b4989751f87a17649810a964fa053">  294</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#adb5b4989751f87a17649810a964fa053">setRunState</a>(<span class="keywordtype">int</span> new_state) { run_state = new_state; }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// Results:</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//  -- 1 - program is running</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">//  -- 0 -pgram is sleeping</span></div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classPCM.html#a5fc8a2d2073ce855558d201883ecf3cd">  300</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classPCM.html#a5fc8a2d2073ce855558d201883ecf3cd">getRunState</a>(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> run_state; }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">bool</span> isBlocked(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> blocked; }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">void</span> setBlocked(<span class="keyword">const</span> <span class="keywordtype">bool</span> new_blocked) { blocked = new_blocked; }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classPCM.html#a4261a7c1980c16cfe289856401aa3bee">  306</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#a4261a7c1980c16cfe289856401aa3bee">allowMultipleInstances</a>()</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        allow_multiple_instances = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786">  312</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">ProgramMode</a> {</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786a0e861144f482697cfa423b012ed42451">  313</a></span>&#160;        <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786a0e861144f482697cfa423b012ed42451">DEFAULT_EVENTS</a> = 0,         </div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786ac092b2b5f351e33046b87e5cee31f38f">  314</a></span>&#160;        <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786ac092b2b5f351e33046b87e5cee31f38f">CUSTOM_CORE_EVENTS</a> = 1,     </div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786a0f2ff80b85b8f9483c7f03544f73fcbd">  315</a></span>&#160;        <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786a0f2ff80b85b8f9483c7f03544f73fcbd">EXT_CUSTOM_CORE_EVENTS</a> = 2, </div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786ad60e2f3b64e27eaaa84d2b07fea8e225">  316</a></span>&#160;        <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786ad60e2f3b64e27eaaa84d2b07fea8e225">INVALID_MODE</a>                </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    };</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">  320</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        Success = 0,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        MSRAccessDenied = 1,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        PMUBusy = 2,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        UnknownError</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    };</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="structPCM_1_1CustomCoreEventDescription.html">  334</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPCM_1_1CustomCoreEventDescription.html">CustomCoreEventDescription</a></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        int32 event_number, umask_value;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    };</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    </div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">  348</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">ExtendedCustomCoreEventDescription</a></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="structFixedEventControlRegister.html">FixedEventControlRegister</a> * fixedCfg; <span class="comment">// if NULL, then default configuration performed for fixed counters</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        uint32 nGPCounters; <span class="comment">// number of general purpose counters</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="structEventSelectRegister.html">EventSelectRegister</a> * gpCounterCfg; <span class="comment">// general purpose counters, if NULL, then default configuration performed for GP counters</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        uint64 OffcoreResponseMsrValue[2];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    };</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">ProgramMode</a> mode;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="structPCM_1_1CustomCoreEventDescription.html">CustomCoreEventDescription</a> coreEventDesc[4];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">        #ifdef _MSC_VER</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    HANDLE numInstancesSemaphore;     <span class="comment">// global semaphore that counts the number of PCM instances on the system</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">        #else</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// global semaphore that counts the number of PCM instances on the system</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    sem_t * numInstancesSemaphore;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">        #endif</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    std::vector&lt;int32&gt; socketRefCore;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">bool</span> canUsePerf;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#ifdef PCM_USE_PERF</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    std::vector&lt; std::vector&lt;int&gt; &gt; perfEventHandle;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">void</span> readPerfData(uint32 core, std::vector&lt;uint64&gt; &amp; data);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        PERF_INST_RETIRED_ANY_POS = 0,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        PERF_CPU_CLK_UNHALTED_THREAD_POS = 1,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        PERF_CPU_CLK_UNHALTED_REF_POS = 2,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        PERF_GEN_EVENT_0_POS = 3,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        PERF_GEN_EVENT_1_POS = 4,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        PERF_GEN_EVENT_2_POS = 5,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        PERF_GEN_EVENT_3_POS = 6</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    };</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        PERF_GROUP_LEADER_COUNTER = PERF_INST_RETIRED_ANY_POS </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    };</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    std::ofstream *outfile; <span class="comment">// output file stream</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    std::streambuf *backup_ofile; <span class="comment">// backup of original output = cout</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">int</span> run_state; <span class="comment">// either running (1) or sleeping (0)</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordtype">bool</span> PMUinUse();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordtype">void</span> cleanupPMU();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">bool</span> decrementInstanceSemaphore(); <span class="comment">// returns true if it was the last instance</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#ifdef __APPLE__</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// OSX does not have sem_getvalue, so we must get the number of instances by a different method</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    uint32 getNumInstances();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    uint32 decrementNumInstances();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    uint32 incrementNumInstances();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">void</span> computeQPISpeedBeckton(<span class="keywordtype">int</span> core_nr);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">void</span> destroyMSR();</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">void</span> computeNominalFrequency();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> isCPUModelSupported(<span class="keywordtype">int</span> model_);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    std::string getSupportedUarchCodenames() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    std::string getUnsupportedMessage() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordtype">bool</span> detectModel();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">bool</span> checkModel();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">void</span> initCStateSupportTables();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">bool</span> discoverSystemTopology();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">void</span> printSystemTopology() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">void</span> initMSR();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">bool</span> detectNominalFrequency();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">void</span> initEnergyMonitoring();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">void</span> initUncoreObjects();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">void</span> programBecktonUncore(<span class="keywordtype">int</span> core);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">void</span> programNehalemEPUncore(<span class="keywordtype">int</span> core);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">void</span> enableJKTWorkaround(<span class="keywordtype">bool</span> enable);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">void</span> readAndAggregateUncoreMCCounters(<span class="keyword">const</span> uint32 socket, CounterStateType &amp; counterState);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">void</span> readAndAggregateEnergyCounters(<span class="keyword">const</span> uint32 socket, CounterStateType &amp; counterState);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">void</span> readPackageThermalHeadroom(<span class="keyword">const</span> uint32 socket, CounterStateType &amp; counterState);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">void</span> readAndAggregatePackageCStateResidencies(<a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> * msr, CounterStateType &amp; result);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">void</span> readQPICounters(<a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; counterState);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">void</span> reportQPISpeed() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    uint32 CX_MSR_PMON_CTRY(uint32 Cbo, uint32 Ctr) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    uint32 CX_MSR_PMON_BOX_FILTER(uint32 Cbo) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    uint32 CX_MSR_PMON_BOX_FILTER1(uint32 Cbo) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    uint32 CX_MSR_PMON_CTLY(uint32 Cbo, uint32 Ctl) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    uint32 CX_MSR_PMON_BOX_CTL(uint32 Cbo) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    uint32 getMaxNumOfCBoxes() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordtype">void</span> programCboOpcodeFilter(<span class="keyword">const</span> uint32 opc, <span class="keyword">const</span> uint32 cbo, <a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> * msr);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">static</span> <a class="code" href="classPCM.html">PCM</a> * <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">getInstance</a>();        <span class="comment">// the only way to get access</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a56eedaa84893f72b1723f8d580ee3329">good</a>();                       <span class="comment">// true if access to CPU counters works</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classPCM.html#ae7ce6762ad3607dbb839b6698f94697a">  465</a></span>&#160;    <span class="keyword">const</span> std::string &amp; <a class="code" href="classPCM.html#ae7ce6762ad3607dbb839b6698f94697a">getErrorMessage</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">return</span> errorMessage;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> <a class="code" href="classPCM.html#abae9577a1a172c944d133bef10683825">program</a>(<span class="keyword">const</span> <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">ProgramMode</a> mode_ = <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786a0e861144f482697cfa423b012ed42451">DEFAULT_EVENTS</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> * parameter_ = NULL); <span class="comment">// program counters and start counting</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> <a class="code" href="classPCM.html#a3a30cec6e4e7a78ec964d194e3844637">programServerUncorePowerMetrics</a>(<span class="keywordtype">int</span> mc_profile, <span class="keywordtype">int</span> pcu_profile, <span class="keywordtype">int</span> * freq_bands = NULL);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#a9f142010bb99ba6b81e93895bfa20252">freezeServerUncoreCounters</a>();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#a617beda55da4de32593a7aa925fe1f02">unfreezeServerUncoreCounters</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classServerUncorePowerState.html">ServerUncorePowerState</a> <a class="code" href="classPCM.html#a9db0d472d9cdc0aa3c6db8ed7bb38f77">getServerUncorePowerState</a>(uint32 socket);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#ac0c8d3764ff95840ece17d632de4df9b">cleanup</a>();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#ad4f5ff2c6ce12f0fb4bb5ae1e5bd157a">resetPMU</a>();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#ade92d30321a659ca54d423eaf0e30e12">getAllCounterStates</a>(<a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; systemState, std::vector&lt;SocketCounterState&gt; &amp; socketStates, std::vector&lt;CoreCounterState&gt; &amp; coreStates);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a617df842e3f4ef9088bc09c62d7c5cd2">isCoreOnline</a>(int32 os_core_id) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a> <a class="code" href="cpucounters_8h.html#ac225ab9b4b77afb098ddefd13025d14c">getSystemCounterState</a>();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a> <a class="code" href="cpucounters_8h.html#a63896fb0783b57857e3ede0f24083a2a">getSocketCounterState</a>(uint32 socket);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="classCoreCounterState.html">CoreCounterState</a> <a class="code" href="cpucounters_8h.html#a3641dfa6466049072b8937ee64b03738">getCoreCounterState</a>(uint32 core);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    uint32 <a class="code" href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">getNumCores</a>();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    uint32 <a class="code" href="classPCM.html#a670b4ea8dce3252539f5e55f94ab932f">getNumOnlineCores</a>();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    uint32 <a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    uint32 <a class="code" href="classPCM.html#aaad049657e9c017c4b5840f36958b1f1">getThreadsPerCore</a>();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a3cb1bbca3a6ddce86dbbf8c944216710">getSMT</a>();                <span class="comment">// returns true iff SMT (&quot;Hyperthreading&quot;) is on</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    uint64 <a class="code" href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">getNominalFrequency</a>(); <span class="comment">// in Hz</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="classPCM.html#a7ca50e5907ef2b7cf7c81a5e069135f7">  596</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classPCM.html#a7ca50e5907ef2b7cf7c81a5e069135f7">SupportedCPUModels</a></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        NEHALEM_EP = 26,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        NEHALEM = 30,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        ATOM = 28,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        ATOM_2 = 53,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        ATOM_CENTERTON = 54,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        ATOM_BAYTRAIL = 55,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        ATOM_AVOTON = 77,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        CLARKDALE = 37,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        WESTMERE_EP = 44,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        NEHALEM_EX = 46,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        WESTMERE_EX = 47,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        SANDY_BRIDGE = 42,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        JAKETOWN = 45,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        IVY_BRIDGE = 58,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        HASWELL = 60,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        HASWELL_ULT = 69,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        HASWELL_2 = 70,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        IVYTOWN = 62,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        HASWELLX = 63,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        END_OF_MODEL_LIST = 0x0ffff</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    };</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">  622</a></span>&#160;    uint32 <a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() { <span class="keywordflow">return</span> cpu_model; }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="classPCM.html#abfe7e00fc21589083988d3f1f7b0ade3">  626</a></span>&#160;    uint32 <a class="code" href="classPCM.html#abfe7e00fc21589083988d3f1f7b0ade3">getOriginalCPUModel</a>() { <span class="keywordflow">return</span> original_cpu_model; }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="classPCM.html#aa1d6e2bcea705f051cd39e04070139c1">  631</a></span>&#160;    int32 <a class="code" href="classPCM.html#aa1d6e2bcea705f051cd39e04070139c1">getSocketId</a>(uint32 core_id)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">return</span> topology[core_id].socket;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classPCM.html#acf164b6843e71199d6c26544df108799">  638</a></span>&#160;    uint64 <a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">if</span> (num_sockets == 2)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keywordflow">return</span> 4;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore &amp;&amp; server_pcicfg_uncore[0])?(server_pcicfg_uncore[0]-&gt;<a class="code" href="classServerPCICFGUncore.html#ac8dc5ffa64ffebcd21b1d5882ab1fe16">getNumQPIPorts</a>()):0;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="classPCM.html#a57f04203c6bef6f9fcdf489c6fea9089">  661</a></span>&#160;    uint32 <a class="code" href="classPCM.html#a57f04203c6bef6f9fcdf489c6fea9089">getMCPerSocket</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore &amp;&amp; server_pcicfg_uncore[0])?(server_pcicfg_uncore[0]-&gt;<a class="code" href="classServerPCICFGUncore.html#acf1af9c95ce0d0d0cd8940a38866a639">getNumMC</a>()):0;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="classPCM.html#aa034407ccfd9901b40a64bc29ffb467a">  681</a></span>&#160;    uint32 <a class="code" href="classPCM.html#aa034407ccfd9901b40a64bc29ffb467a">getMCChannelsPerSocket</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">return</span> 4;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore &amp;&amp; server_pcicfg_uncore[0])?(server_pcicfg_uncore[0]-&gt;<a class="code" href="classServerPCICFGUncore.html#a52ceae2a7ca82345dbf0b9333ca12038">getNumMCChannels</a>()):0;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="classPCM.html#a5e5450e5ce7c995410d7ac7e6e1cb1a4">  702</a></span>&#160;    uint32 <a class="code" href="classPCM.html#a5e5450e5ce7c995410d7ac7e6e1cb1a4">getMaxIPC</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">case</span> SANDY_BRIDGE:</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">case</span> IVY_BRIDGE:</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">case</span> HASWELL:</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordflow">return</span> 4;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">case</span> ATOM:</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="classPCM.html#a88ae0774aeb6d92f7533ff4bdfe77787">  725</a></span>&#160;    uint64 <a class="code" href="classPCM.html#a88ae0774aeb6d92f7533ff4bdfe77787">getPCUFrequency</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">return</span> 800000000ULL; <span class="comment">// 800 MHz</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">return</span> 1000000000ULL; <span class="comment">// 1 GHz</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    uint64 <a class="code" href="classPCM.html#a794f5852662a2827b34eb16025564c70">getTickCount</a>(uint64 multiplier = 1000 <span class="comment">/* ms */</span>, uint32 core = 0);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    uint64 <a class="code" href="classPCM.html#a0d5153c7ec05003da7d20aeea737113e">getTickCountRDTSCP</a>(uint64 multiplier = 1000 <span class="comment">/* ms */</span>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="classPCM.html#a7d302193e0799272e62ba8c5e857a305">  754</a></span>&#160;    uint64 <a class="code" href="classPCM.html#a7d302193e0799272e62ba8c5e857a305">getQPILinkSpeed</a>(uint32 socketNr, uint32 linkNr)<span class="keyword"> const</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keyword">       </span>{ <span class="keywordflow">return</span> hasPCICFGUncore() ? server_pcicfg_uncore[socketNr]-&gt;<a class="code" href="classServerPCICFGUncore.html#af5c42a5eb97b97f17a3cb0010bd04642">getQPILinkSpeed</a>(linkNr) : max_qpi_speed; }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="classPCM.html#a81ed5d9b2caa55615bc9b6c4e65eccb4">  758</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classPCM.html#a81ed5d9b2caa55615bc9b6c4e65eccb4">getJoulesPerEnergyUnit</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> joulesPerEnergyUnit; }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="classPCM.html#a6a1e83a12ad11bbefde28ef0363e2663">  761</a></span>&#160;    int32 <a class="code" href="classPCM.html#a6a1e83a12ad11bbefde28ef0363e2663">getPackageThermalSpecPower</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pkgThermalSpecPower; }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="classPCM.html#a1aa93f0a086f91b63c9a3f5375ef2f07">  764</a></span>&#160;    int32 <a class="code" href="classPCM.html#a1aa93f0a086f91b63c9a3f5375ef2f07">getPackageMinimumPower</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pkgMinimumPower; }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classPCM.html#a8f649340620d5ca7514d26861d9d79a4">  767</a></span>&#160;    int32 <a class="code" href="classPCM.html#a8f649340620d5ca7514d26861d9d79a4">getPackageMaximumPower</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pkgMaximumPower; }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a5e4cabfe4223f1d2e7e1e0da8b1179b3">initWinRing0Lib</a>();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> disableJKTWorkaround() { disable_JKT_workaround = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keyword">enum</span> PCIeEventCode</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="comment">// PCIe read events (PCI devices reading from memory - application writes to disk/network/PCIe device)</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        PCIeRdCur = 0x19E, <span class="comment">// PCIe read current (full cache line)</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        PCIeNSRd = 0x1E4,  <span class="comment">// PCIe non-snoop read (full cache line)</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="comment">// PCIe write events (PCI devices writing to memory - application reads from disk/network/PCIe device)</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        PCIeWiLF = 0x194,  <span class="comment">// PCIe Write (non-allocating) (full cache line)</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        PCIeItoM = 0x19C,  <span class="comment">// PCIe Write (allocating) (full cache line)</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        PCIeNSWr = 0x1E5,  <span class="comment">// PCIe Non-snoop write (partial cache line)</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        PCIeNSWrF = 0x1E6, <span class="comment">// PCIe Non-snoop write (full cache line)</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="comment">// events shared by CPU and IO</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        RFO = 0x180,       <span class="comment">// Demand Data RFO; share the same code for CPU, use tid to filter PCIe only traffic</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        CRd = 0x181,       <span class="comment">// Demand Code Read</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        DRd = 0x182,       <span class="comment">// Demand Data Read</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        PRd = 0x187,       <span class="comment">// Partial Reads (UC) (MMIO Read)</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        WiL = 0x18F,       <span class="comment">// Write Invalidate Line - partial (MMIO write), PL: Not documented in HSX/IVT</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        ItoM = 0x1C8,      <span class="comment">// Request Invalidate Line; share the same code for CPU, use tid to filter PCIe only traffic</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    };</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keyword">enum</span> CBoEventTid</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        RFOtid = 0x3E,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        ItoMtid = 0x3E,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    };</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#a55f62ca7429cf9a72db8c0a21931374a">programPCIeCounters</a>(<span class="keyword">const</span> PCIeEventCode event_, <span class="keyword">const</span> uint32 tid_ = 0, <span class="keyword">const</span> uint32 miss_ = 0);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">void</span> programPCIeMissCounters(<span class="keyword">const</span> PCIeEventCode event_, <span class="keyword">const</span> uint32 tid_ = 0);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="classPCIeCounterState.html">PCIeCounterState</a> <a class="code" href="classPCM.html#a3b1b549672af4c14c00eb7d461c87ac4">getPCIeCounterState</a>(<span class="keyword">const</span> uint32 socket_);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    uint64 extractCoreGenCounterValue(uint64 val);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    uint64 extractCoreFixedCounterValue(uint64 val);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    uint64 extractUncoreGenCounterValue(uint64 val);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    uint64 extractUncoreFixedCounterValue(uint64 val);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classPCM.html#a7a895ed54c20b38bbfbb47c9246c2e95">getUArchCodename</a>(int32 cpu_model_ = -1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keyword">static</span> std::string <a class="code" href="classPCM.html#a3279d88bbd5c2eab06c9c6cb6248c3c7">getCPUBrandString</a>();</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">bool</span> packageEnergyMetricsAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    cpu_model == PCM::JAKETOWN</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                 || cpu_model == PCM::IVYTOWN</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                 || cpu_model == PCM::SANDY_BRIDGE </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                 || cpu_model == PCM::IVY_BRIDGE</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                 || cpu_model == PCM::HASWELL</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                 || original_cpu_model == PCM::ATOM_AVOTON</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                 || cpu_model == PCM::HASWELLX</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;               );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordtype">bool</span> dramEnergyMetricsAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">return</span> ( </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;             cpu_model == PCM::JAKETOWN</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          || cpu_model == PCM::IVYTOWN</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          || cpu_model == PCM::HASWELLX</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          );</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">bool</span> packageThermalMetricsAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">return</span> packageEnergyMetricsAvailable();</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">bool</span> outgoingQPITrafficMetricsAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                cpu_model == PCM::NEHALEM_EX </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            ||  cpu_model == PCM::WESTMERE_EX </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            ||  cpu_model == PCM::JAKETOWN</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            ||  cpu_model == PCM::IVYTOWN</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            ||  cpu_model == PCM::HASWELLX</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;               );</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">bool</span> qpiUtilizationMetricsAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">return</span> outgoingQPITrafficMetricsAvailable();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">bool</span> memoryTrafficMetricsAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">return</span> !(</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                  cpu_model == PCM::ATOM </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;               || cpu_model == PCM::CLARKDALE</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#if !defined(__linux__) &amp;&amp; !defined(__FreeBSD__) &amp;&amp; !defined(__APPLE__)</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;               || cpu_model == PCM::SANDY_BRIDGE</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;               || cpu_model == PCM::IVY_BRIDGE</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;               || cpu_model == PCM::HASWELL</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;               );</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">bool</span> memoryIOTrafficMetricAvailable()<span class="keyword"> const</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                cpu_model == PCM::SANDY_BRIDGE</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            ||  cpu_model == PCM::IVY_BRIDGE</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            ||  cpu_model == PCM::HASWELL</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;               );</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordtype">bool</span> hasBecktonUncore()<span class="keyword"> const</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              cpu_model == PCM::NEHALEM_EX</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          ||  cpu_model == PCM::WESTMERE_EX</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;               );</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">bool</span> hasPCICFGUncore() const <span class="comment">// has PCICFG uncore PMON</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">return</span> (</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;              cpu_model == PCM::JAKETOWN</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          ||  cpu_model == PCM::IVYTOWN</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          ||  cpu_model == PCM::HASWELLX</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;               );</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    ~<a class="code" href="classPCM.html">PCM</a>();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;};</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno"><a class="line" href="classBasicCounterState.html">  910</a></span>&#160;<span class="keyword">class </span><a class="code" href="classBasicCounterState.html">BasicCounterState</a></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;{</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#aa398facfd523b7dcdbf827a74970a88c">getAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a963d78be64ccddb4f7686405ef4df9c1">getActiveAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a89d4cef9c83db7e76be6a0a2e7351e2e">getCyclesLostDueL3CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#ac26765efe8a4c7341f40c8ab8bdb9af6">getCyclesLostDueL2CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a806e72bc51f05acc4af0667ca3334242">getRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a9a351e598b8af26131611ff37b592633">getActiveRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a5922acedeec3c1cc67d20670f8ef0518">getL2CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a7b03f0cd02862716d717e897032b7885">getL3CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; now);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; now);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#abaa9d828b52f41866bf7dc8ff491a62e">getNumberOfCustomEvents</a>(int32 eventCounterNr, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classBasicCounterState.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classBasicCounterState.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    uint64 InstRetiredAny;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    uint64 CpuClkUnhaltedThread;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    uint64 CpuClkUnhaltedRef;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        uint64 L3Miss;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        uint64 Event0;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        uint64 ArchLLCMiss;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    };</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        uint64 L3UnsharedHit;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        uint64 Event1;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        uint64 ArchLLCRef;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    };</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        uint64 L2HitM;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        uint64 Event2;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    };</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        uint64 L2Hit;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        uint64 Event3;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    };</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    uint64 InvariantTSC; <span class="comment">// invariant time stamp counter</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    uint64 CStateResidency[PCM::MAX_C_STATE + 1];</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    int32 ThermalHeadroom;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(<a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> *);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a>() : </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      InstRetiredAny(0)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    , CpuClkUnhaltedThread(0)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    , CpuClkUnhaltedRef(0)</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    , L3Miss(0)</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    , L3UnsharedHit(0)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    , L2HitM(0)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    , L2Hit(0)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    , InvariantTSC(0) </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    , ThermalHeadroom(PCM_INVALID_THERMAL_HEADROOM)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        memset(&amp;(CStateResidency[0]), 0, <span class="keyword">sizeof</span>(CStateResidency));</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classBasicCounterState.html">BasicCounterState</a>() { }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a> &amp; operator += (<span class="keyword">const</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a> &amp; o)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        InstRetiredAny += o.InstRetiredAny;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        CpuClkUnhaltedThread += o.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        CpuClkUnhaltedRef += o.CpuClkUnhaltedRef;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        Event0 += o.Event0;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        Event1 += o.Event1;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        Event2 += o.Event2;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        Event3 += o.Event3;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        InvariantTSC += o.InvariantTSC;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt;= PCM::MAX_C_STATE ;++i)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            CStateResidency[i] += o.CStateResidency[i];</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">// ThermalHeadroom is not accumulative</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"><a class="line" href="classBasicCounterState.html#a5411f6d468e66da3357a41f3c0fd1cb2"> 1020</a></span>&#160;   int32 <a class="code" href="classBasicCounterState.html#a5411f6d468e66da3357a41f3c0fd1cb2">getThermalHeadroom</a>()<span class="keyword"> const  </span>{ <span class="keywordflow">return</span> ThermalHeadroom; }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;};</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336"> 1029</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">return</span> after.QPIClocks[port] - before.QPIClocks[port];</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;int32 getThermalHeadroom(<span class="keyword">const</span> CounterStateType &amp; <span class="comment">/* before */</span>, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;{</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">return</span> after.getThermalHeadroom();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;}</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01047"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3"> 1047</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;{</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">return</span> after.QPIL0pTxCycles[port] - before.QPIL0pTxCycles[port];</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01058"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095"> 1058</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;{</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordflow">return</span> after.QPIL1Cycles[port] - before.QPIL1Cycles[port];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01070"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aa5a7caff83891aafc6e9eb20501170cc"> 1070</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#aa5a7caff83891aafc6e9eb20501170cc">getNormalizedQPIL0pTxCycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;{</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(port,before,after))/double(<a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(port,before,after));</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01082"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0ea54e2a783ce71cef06350aed099104"> 1082</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a0ea54e2a783ce71cef06350aed099104">getNormalizedQPIL1Cycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;{</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(port,before,after))/double(<a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(port,before,after));</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;}</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17"> 1093</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a>(uint32 channel, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;{</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">return</span> after.DRAMClocks[channel] - before.DRAMClocks[channel];</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01105"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f"> 1105</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a>(uint32 channel, uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;{</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="keywordflow">return</span> after.MCCounter[channel][counter] - before.MCCounter[channel][counter];</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;}</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d"> 1116</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a>(uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;{</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">return</span> after.PCUCounter[counter] - before.PCUCounter[counter];</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01126"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#acd430f703c67fc7dc0829d624ba657af"> 1126</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#acd430f703c67fc7dc0829d624ba657af">getPCUClocks</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;{</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a>(0,before,after);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01136"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8"> 1136</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">return</span> after.PackageEnergyStatus - before.PackageEnergyStatus;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01146"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda"> 1146</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;{</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">return</span> after.DRAMEnergyStatus - before.DRAMEnergyStatus;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;}</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#af8f7dab111f6b8cbcfa0c1b81e1860fb"> 1156</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#af8f7dab111f6b8cbcfa0c1b81e1860fb">getConsumedJoules</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;{</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">if</span>(!m) <span class="keywordflow">return</span> -1.;  </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(before,after))*m-&gt;<a class="code" href="classPCM.html#a81ed5d9b2caa55615bc9b6c4e65eccb4">getJoulesPerEnergyUnit</a>();</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01169"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ab6f97a3386ac2d35dfd61148acde0a53"> 1169</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ab6f97a3386ac2d35dfd61148acde0a53">getDRAMConsumedJoules</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;{</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;   <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;   <span class="keywordflow">if</span>(!m) <span class="keywordflow">return</span> -1.;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(before,after))*m-&gt;<a class="code" href="classPCM.html#a81ed5d9b2caa55615bc9b6c4e65eccb4">getJoulesPerEnergyUnit</a>();</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;}</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"><a class="line" href="classUncoreCounterState.html"> 1181</a></span>&#160;<span class="keyword">class </span><a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;{</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classUncoreCounterState.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classUncoreCounterState.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classUncoreCounterState.html#a7e5434dba3a810501f289329e52b889d">getIORequestBytesFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classUncoreCounterState.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classUncoreCounterState.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);    </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classUncoreCounterState.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    uint64 UncMCFullWrites;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    uint64 UncMCNormalReads;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    uint64 UncMCIORequests;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    uint64 PackageEnergyStatus;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    uint64 DRAMEnergyStatus;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    uint64 CStateResidency[PCM::MAX_C_STATE + 1];</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(<a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> *);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>() :</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;       UncMCFullWrites(0)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;     , UncMCNormalReads(0)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;     , UncMCIORequests(0)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;     , PackageEnergyStatus(0)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;     , DRAMEnergyStatus(0)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        memset(&amp;(CStateResidency[0]), 0, <span class="keyword">sizeof</span>(CStateResidency));</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>() { }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a> &amp; operator += (<span class="keyword">const</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a> &amp; o)</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        UncMCFullWrites += o.UncMCFullWrites;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        UncMCNormalReads += o.UncMCNormalReads;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        UncMCIORequests += o.UncMCIORequests;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        PackageEnergyStatus += o.PackageEnergyStatus;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        DRAMEnergyStatus += o.DRAMEnergyStatus;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt;= PCM::MAX_C_STATE ;++i)</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            CStateResidency[i] += o.CStateResidency[i];</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;};</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"><a class="line" href="classServerUncorePowerState.html"> 1232</a></span>&#160;<span class="keyword">class </span><a class="code" href="classServerUncorePowerState.html">ServerUncorePowerState</a>: <span class="keyword">public</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;{</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   uint64 QPIClocks[3], QPIL0pTxCycles[3], QPIL1Cycles[3];</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   uint64 DRAMClocks[8];</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;   uint64 MCCounter[8][4];<span class="comment">// channel X counter</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   uint64 PCUCounter[4];</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   int32 PackageThermalHeadroom;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   uint64 InvariantTSC; <span class="comment">// invariant time stamp counter</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a>(uint32 channel, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a>(uint32 channel, uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a>(uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   <span class="keyword">friend</span> uint64 <a class="code" href="classServerUncorePowerState.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01261"></a><span class="lineno"><a class="line" href="classServerUncorePowerState.html#a2680b28b8d92da4cf74a3a1c59bf7c1d"> 1261</a></span>&#160;   int32 <a class="code" href="classServerUncorePowerState.html#a2680b28b8d92da4cf74a3a1c59bf7c1d">getPackageThermalHeadroom</a>()<span class="keyword"> const  </span>{ <span class="keywordflow">return</span> PackageThermalHeadroom; }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   <a class="code" href="classServerUncorePowerState.html">ServerUncorePowerState</a>() :</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      PackageThermalHeadroom(0)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    , InvariantTSC(0)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      memset(&amp;(QPIClocks[0]), 0, 3*<span class="keyword">sizeof</span>(uint64));</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      memset(&amp;(QPIL0pTxCycles[0]), 0, 3*<span class="keyword">sizeof</span>(uint64));</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      memset(&amp;(QPIL1Cycles[0]), 0, 3*<span class="keyword">sizeof</span>(uint64));</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      memset(&amp;(DRAMClocks[0]), 0, 8*<span class="keyword">sizeof</span>(uint64));</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      memset(&amp;(PCUCounter[0]), 0, 4*<span class="keyword">sizeof</span>(uint64));</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;8;++i)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        memset(&amp;(MCCounter[i][0]), 0, 4*<span class="keyword">sizeof</span>(uint64));</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;   }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;};</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"><a class="line" href="classCoreCounterState.html"> 1277</a></span>&#160;<span class="keyword">class </span><a class="code" href="classCoreCounterState.html">CoreCounterState</a> : <span class="keyword">public</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;{</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;};</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"><a class="line" href="classSocketCounterState.html"> 1285</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSocketCounterState.html">SocketCounterState</a> : <span class="keyword">public</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a>, <span class="keyword">public</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;{</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(<a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> * handle)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        BasicCounterState::readAndAggregate(handle);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        UncoreCounterState::readAndAggregate(handle);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordtype">void</span> accumulateCoreState(<span class="keyword">const</span> <a class="code" href="classCoreCounterState.html">CoreCounterState</a> &amp; o)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        BasicCounterState::operator += (o);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;};</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"><a class="line" href="classSystemCounterState.html"> 1304</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSystemCounterState.html">SystemCounterState</a> : <span class="keyword">public</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a>, <span class="keyword">public</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;{</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    std::vector&lt;std::vector&lt;uint64&gt; &gt; incomingQPIPackets;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    std::vector&lt;std::vector&lt;uint64&gt; &gt; outgoingQPIIdleFlits;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    std::vector&lt;std::vector&lt;uint64&gt; &gt; outgoingQPIDataNonDataFlits;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    uint64 uncoreTSC;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(<a class="code" href="classSafeMsrHandle.html">SafeMsrHandle</a> * handle)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        BasicCounterState::readAndAggregate(handle);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        UncoreCounterState::readAndAggregate(handle);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classSystemCounterState.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classSystemCounterState.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="classSystemCounterState.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classSystemCounterState.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="classSystemCounterState.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a>() :</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        uncoreTSC(0)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        incomingQPIPackets.resize(m-&gt;<a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>(),</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                  std::vector&lt;uint64&gt;((uint32)m-&gt;<a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>(), 0));</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        outgoingQPIIdleFlits.resize(m-&gt;<a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>(),</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                    std::vector&lt;uint64&gt;((uint32)m-&gt;<a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>(), 0));</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        outgoingQPIDataNonDataFlits.resize(m-&gt;<a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>(),</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                    std::vector&lt;uint64&gt;((uint32)m-&gt;<a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>(), 0));</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordtype">void</span> accumulateSocketState(<span class="keyword">const</span> <a class="code" href="classSocketCounterState.html">SocketCounterState</a> &amp; o)</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">if</span> (&amp;o != NULL) <span class="comment">// security check requirement</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            BasicCounterState::operator += (o);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            UncoreCounterState::operator += (o);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;};</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;INTELPCM_API <a class="code" href="classSystemCounterState.html">SystemCounterState</a> <a class="code" href="cpucounters_8h.html#ac225ab9b4b77afb098ddefd13025d14c">getSystemCounterState</a>();</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;INTELPCM_API <a class="code" href="classSocketCounterState.html">SocketCounterState</a> <a class="code" href="cpucounters_8h.html#a63896fb0783b57857e3ede0f24083a2a">getSocketCounterState</a>(uint32 socket);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;INTELPCM_API <a class="code" href="classCoreCounterState.html">CoreCounterState</a> <a class="code" href="cpucounters_8h.html#a3641dfa6466049072b8937ee64b03738">getCoreCounterState</a>(uint32 core);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01384"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22"> 1384</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// instructions per cycle</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;{</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">if</span> (clocks != 0)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">return</span> double(after.InstRetiredAny - before.InstRetiredAny) / double(clocks);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;}</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01400"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771"> 1400</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// instructions</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;{</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">return</span> after.InstRetiredAny - before.InstRetiredAny;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01412"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0"> 1412</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// usage</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;{</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    int64 timer_clocks = after.InvariantTSC - before.InvariantTSC;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">if</span> (timer_clocks != 0)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">return</span> double(after.InstRetiredAny - before.InstRetiredAny) / double(timer_clocks);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;}</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01426"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#afced47e4bb3712da79dc64cb16ac335a"> 1426</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; now) <span class="comment">// instructions</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;{</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">return</span> now.InstRetiredAny;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;}</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01449"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4"> 1449</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// clocks</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;{</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">return</span> after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01465"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326"> 1465</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// clocks</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;{</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">return</span> after.CpuClkUnhaltedRef - before.CpuClkUnhaltedRef;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;}</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01478"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#adc17d576ecaf02cf98cebc86329bf2a1"> 1478</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; now) <span class="comment">// clocks</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;{</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">return</span> now.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;}</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#abaca7147e6334e13bbbc718e4a537568"> 1491</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#abaca7147e6334e13bbbc718e4a537568">getCoreIPC</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after) <span class="comment">// instructions per cycle</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;{</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordtype">double</span> ipc = <a class="code" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a>(before, after);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordflow">if</span> (ipc &gt;= 0. &amp;&amp; m &amp;&amp; (m-&gt;<a class="code" href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">getNumCores</a>() == m-&gt;<a class="code" href="classPCM.html#a670b4ea8dce3252539f5e55f94ab932f">getNumOnlineCores</a>()))</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        <span class="keywordflow">return</span> ipc * double(m-&gt;<a class="code" href="classPCM.html#aaad049657e9c017c4b5840f36958b1f1">getThreadsPerCore</a>());</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;}</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01511"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a546944a165ea621d77a524b15ccd6cf1"> 1511</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a546944a165ea621d77a524b15ccd6cf1">getTotalExecUsage</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after) <span class="comment">// usage</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;{</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keywordtype">double</span> usage = <a class="code" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a>(before, after);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">if</span> (usage &gt;= 0. &amp;&amp; m &amp;&amp; (m-&gt;<a class="code" href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">getNumCores</a>() == m-&gt;<a class="code" href="classPCM.html#a670b4ea8dce3252539f5e55f94ab932f">getNumOnlineCores</a>()))</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordflow">return</span> usage * double(m-&gt;<a class="code" href="classPCM.html#aaad049657e9c017c4b5840f36958b1f1">getThreadsPerCore</a>());</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;}</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01527"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c"> 1527</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c">getAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// in Hz</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;{</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    int64 timer_clocks = after.InvariantTSC - before.InvariantTSC;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (timer_clocks != 0 &amp;&amp; m)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">return</span> double(m-&gt;<a class="code" href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">getNominalFrequency</a>()) * <span class="keywordtype">double</span>(clocks) / double(timer_clocks);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;}</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01544"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1"> 1544</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1">getActiveAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// in Hz</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;{</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    int64 ref_clocks = after.CpuClkUnhaltedRef - before.CpuClkUnhaltedRef;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">if</span> (ref_clocks != 0 &amp;&amp; m)</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keywordflow">return</span> double(m-&gt;<a class="code" href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">getNominalFrequency</a>()) * <span class="keywordtype">double</span>(clocks) / double(ref_clocks);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;}</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01561"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242"> 1561</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242">getRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// fraction of nominal frequency</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;{</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    int64 timer_clocks = after.InvariantTSC - before.InvariantTSC;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span> (timer_clocks != 0)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keywordflow">return</span> double(clocks) / double(timer_clocks);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;}</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01577"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633"> 1577</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633">getActiveRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// fraction of nominal frequency</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;{</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    int64 ref_clocks = after.CpuClkUnhaltedRef - before.CpuClkUnhaltedRef;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">if</span> (ref_clocks != 0)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">return</span> double(clocks) / double(ref_clocks);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;}</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01594"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a89d4cef9c83db7e76be6a0a2e7351e2e"> 1594</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a89d4cef9c83db7e76be6a0a2e7351e2e">getCyclesLostDueL3CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// 0.0 - 1.0</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;{</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordflow">if</span> (clocks != 0)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="keywordflow">return</span> 180. * double(after.L3Miss - before.L3Miss) / double(clocks);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01614"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ac26765efe8a4c7341f40c8ab8bdb9af6"> 1614</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ac26765efe8a4c7341f40c8ab8bdb9af6">getCyclesLostDueL2CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// 0.0 - 1.0</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;{</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">if</span> (clocks != 0)</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        <span class="keywordtype">double</span> L3UnsharedHit = (double)(after.L3UnsharedHit - before.L3UnsharedHit);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordtype">double</span> L2HitM = (double)(after.L2HitM - before.L2HitM);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">return</span> (35. * L3UnsharedHit + 74. * L2HitM) / double(clocks);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;}</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01635"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518"> 1635</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518">getL2CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// 0.0 - 1.0</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;{</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        uint64 L2Miss = after.ArchLLCMiss - before.ArchLLCMiss;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        uint64 L2Ref = after.ArchLLCRef - before.ArchLLCRef;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">if</span> (L2Ref) <span class="keywordflow">return</span> 1. - (double(L2Miss) / double(L2Ref));</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    uint64 L3Miss = after.L3Miss - before.L3Miss;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    uint64 L3UnsharedHit = after.L3UnsharedHit - before.L3UnsharedHit;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    uint64 L2HitM = after.L2HitM - before.L2HitM;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    uint64 L2Hit = after.L2Hit - before.L2Hit;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    uint64 hits = L2Hit;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    uint64 all = L2Hit + L2HitM + L3UnsharedHit + L3Miss;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">if</span> (all) <span class="keywordflow">return</span> double(hits) / double(all);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;}</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01663"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885"> 1663</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885">getL3CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// 0.0 - 1.0</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;{</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    uint64 L3Miss = after.L3Miss - before.L3Miss;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    uint64 L3UnsharedHit = after.L3UnsharedHit - before.L3UnsharedHit;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    uint64 L2HitM = after.L2HitM - before.L2HitM;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    uint64 hits = L3UnsharedHit + L2HitM;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    uint64 all = L2HitM + L3UnsharedHit + L3Miss;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">if</span> (all) <span class="keywordflow">return</span> double(hits) / double(all);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;}</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01685"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343"> 1685</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;{</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordflow">return</span> after.L3Miss - before.L3Miss;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;}</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01699"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58"> 1699</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;{</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">return</span> after.ArchLLCMiss - before.ArchLLCMiss;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    uint64 L3Miss = after.L3Miss - before.L3Miss;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    uint64 L3UnsharedHit = after.L3UnsharedHit - before.L3UnsharedHit;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    uint64 L2HitM = after.L2HitM - before.L2HitM;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">return</span> L2HitM + L3UnsharedHit + L3Miss;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;}</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01719"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61"> 1719</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;{</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        uint64 L2Miss = after.ArchLLCMiss - before.ArchLLCMiss;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        uint64 L2Ref = after.ArchLLCRef - before.ArchLLCRef;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">return</span> L2Ref - L2Miss;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">return</span> after.L2Hit - before.L2Hit;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;}</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01738"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2"> 1738</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;{</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">return</span> after.L3UnsharedHit - before.L3UnsharedHit;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;}</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01752"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f"> 1752</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;{</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">return</span> after.L2HitM - before.L2HitM;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;}</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01767"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6"> 1767</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;{</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">getCPUModel</a>() == PCM::ATOM) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a>(before, after) + <a class="code" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a>(before, after);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;}</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01782"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9"> 1782</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;{</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">return</span> after.InvariantTSC - before.InvariantTSC;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;}</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01795"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce"> 1795</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;{</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tsc = double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before,after));</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">if</span>(state == 0) <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(before,after))/tsc;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">if</span>(state == 1)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordtype">double</span> result = 1.0 - double(<a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(before,after))/tsc; <span class="comment">// 1.0 - cC0</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 2; i &lt;= PCM::MAX_C_STATE; ++i)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            <span class="keywordflow">if</span>(m-&gt;<a class="code" href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">isCoreCStateResidencySupported</a>(state))</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                result -= (after.BasicCounterState::CStateResidency[i] - before.BasicCounterState::CStateResidency[i])/tsc;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">if</span>(result &lt; 0.) result = 0.; <span class="comment">// fix counter dissynchronization</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(result &gt; 1.) result = 1.; <span class="comment">// fix counter dissynchronization</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordflow">return</span> (after.BasicCounterState::CStateResidency[state] - before.BasicCounterState::CStateResidency[state])/tsc;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;}</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01825"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38"> 1825</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;{</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordflow">return</span> double(after.UncoreCounterState::CStateResidency[state] - before.UncoreCounterState::CStateResidency[state])/double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before,after));</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;}</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01838"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f"> 1838</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;{</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordflow">return</span> (after.UncMCNormalReads - before.UncMCNormalReads) * 64;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;}</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01850"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1"> 1850</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;{</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">return</span> (after.UncMCFullWrites - before.UncMCFullWrites) * 64;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;}</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01862"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d"> 1862</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d">getIORequestBytesFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;{</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="keywordflow">return</span> (after.UncMCIORequests - before.UncMCIORequests) * 64;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;}</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div>
<div class="line"><a name="l01877"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e"> 1877</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e">getNumberOfCustomEvents</a>(int32 eventCounterNr, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;{</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">return</span> ((&amp;after.Event0)[eventCounterNr] - (&amp;before.Event0)[eventCounterNr]);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;}</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01892"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3"> 1892</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;{</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    uint64 b = before.incomingQPIPackets[socketNr][linkNr];</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    uint64 a = after.incomingQPIPackets[socketNr][linkNr];</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="comment">// prevent overflows due to counter dissynchronisation</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">return</span> (a &gt; b) ? (64 * (a - b)) : 0;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;}</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div>
<div class="line"><a name="l01910"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0ba3a5b71b7dd6b84c345f8cbc795b1c"> 1910</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a0ba3a5b71b7dd6b84c345f8cbc795b1c">getIncomingQPILinkUtilization</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;{</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">if</span> (!(m-&gt;qpiUtilizationMetricsAvailable())) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> bytes = (double)<a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(socketNr, linkNr, before, after);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keyword">const</span> uint64 max_speed = m-&gt;<a class="code" href="classPCM.html#a7d302193e0799272e62ba8c5e857a305">getQPILinkSpeed</a>(socketNr, linkNr);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> max_bytes = (double)(<span class="keywordtype">double</span>(max_speed) * double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after) / <span class="keywordtype">double</span>(m-&gt;<a class="code" href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">getNumCores</a>())) / double(m-&gt;<a class="code" href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">getNominalFrequency</a>()));</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordflow">return</span> bytes / max_bytes;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;}</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01931"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773"> 1931</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;{</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">if</span>(m-&gt;hasBecktonUncore())</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;       <span class="keyword">const</span> uint64 b = before.outgoingQPIIdleFlits[socketNr][linkNr];</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;       <span class="keyword">const</span> uint64 a = after.outgoingQPIIdleFlits[socketNr][linkNr];</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;       <span class="comment">// prevent overflows due to counter dissynchronisation</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> idle_flits = (double)((a &gt; b) ? (a - b) : 0);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;       <span class="keyword">const</span> uint64 bTSC = before.uncoreTSC;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;       <span class="keyword">const</span> uint64 aTSC = after.uncoreTSC;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> tsc = (double)((aTSC &gt; bTSC) ? (aTSC - bTSC) : 0);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;       <span class="keywordflow">if</span>(idle_flits &gt; tsc) <span class="keywordflow">return</span> 0.; <span class="comment">// prevent oveflows due to potential counter dissynchronization</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;       <span class="keywordflow">return</span> (1. - (idle_flits / tsc));</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(m-&gt;hasPCICFGUncore())</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keyword">const</span> uint64 b = before.outgoingQPIDataNonDataFlits[socketNr][linkNr];</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keyword">const</span> uint64 a = after.outgoingQPIDataNonDataFlits[socketNr][linkNr];</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;       <span class="comment">// prevent overflows due to counter dissynchronisation</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> flits = (double)((a &gt; b) ? (a - b) : 0);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> max_flits = ((double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after))*double(m-&gt;<a class="code" href="classPCM.html#a7d302193e0799272e62ba8c5e857a305">getQPILinkSpeed</a>(socketNr, linkNr))/(2.0*4.0))/<span class="keywordtype">double</span>(m-&gt;<a class="code" href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">getNominalFrequency</a>()))/double(m-&gt;<a class="code" href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">getNumCores</a>());</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keywordflow">if</span>(flits &gt; max_flits) <span class="keywordflow">return</span> 1.; <span class="comment">// prevent oveflows due to potential counter dissynchronization</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="keywordflow">return</span> (flits / max_flits);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;}</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div>
<div class="line"><a name="l01971"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23"> 1971</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;{</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">if</span> (!(m-&gt;outgoingQPITrafficMetricsAvailable())) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> util = <a class="code" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a>(socketNr, linkNr, before, after);</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> max_bytes = (double(m-&gt;<a class="code" href="classPCM.html#a7d302193e0799272e62ba8c5e857a305">getQPILinkSpeed</a>(socketNr, linkNr)) * <span class="keywordtype">double</span>(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after) / double(m-&gt;<a class="code" href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">getNumCores</a>())) / double(m-&gt;<a class="code" href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">getNominalFrequency</a>()));</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">return</span> (uint64)(max_bytes * util);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;}</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404"> 1991</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;{</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keyword">const</span> uint32 ns = m-&gt;<a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>();</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keyword">const</span> uint32 qpiLinks = (uint32)m-&gt;<a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>();</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    uint64 sum = 0;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keywordflow">for</span> (uint32 s = 0; s &lt; ns; ++s)</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="keywordflow">for</span> (uint32 q = 0; q &lt; qpiLinks; ++q)</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            sum += <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(s, q, before, after);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;}</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0b914c4bffa783271c276b29be582370"> 2013</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a0b914c4bffa783271c276b29be582370">getAllOutgoingQPILinkBytes</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;{</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keyword">const</span> uint32 ns = m-&gt;<a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>();</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keyword">const</span> uint32 qpiLinks = (uint32)m-&gt;<a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>();</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    uint64 sum = 0;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keywordflow">for</span> (uint32 s = 0; s &lt; ns; ++s)</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        <span class="keywordflow">for</span> (uint32 q = 0; q &lt; qpiLinks; ++q)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            sum += <a class="code" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(s, q, before, after);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;}</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a42d6a119a26ea41c40d5585356d832ca"> 2037</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now)</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;{</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="keywordflow">return</span> 64 * now.incomingQPIPackets[socketNr][linkNr];</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;}</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div>
<div class="line"><a name="l02050"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd"> 2050</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd">getSocketIncomingQPILinkBytes</a>(uint32 socketNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now)</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;{</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keyword">const</span> uint32 qpiLinks = (uint32)m-&gt;<a class="code" href="classPCM.html#acf164b6843e71199d6c26544df108799">getQPILinksPerSocket</a>();</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    uint64 sum = 0;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="keywordflow">for</span> (uint32 q = 0; q &lt; qpiLinks; ++q)</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        sum += <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(socketNr, q, now);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;}</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div>
<div class="line"><a name="l02069"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ad21f46c2ea28e3ca5c074fc7749b7395"> 2069</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;{</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keyword">const</span> uint32 ns = m-&gt;<a class="code" href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">getNumSockets</a>();</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    uint64 sum = 0;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="keywordflow">for</span> (uint32 s = 0; s &lt; ns; ++s)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        sum += <a class="code" href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd">getSocketIncomingQPILinkBytes</a>(s, now);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;}</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div>
<div class="line"><a name="l02090"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a17823150d51bdebdd203dfa00b0a5f49"> 2090</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a17823150d51bdebdd203dfa00b0a5f49">getQPItoMCTrafficRatio</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;{</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="keyword">const</span> uint64 totalQPI = <a class="code" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a>(before, after);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keyword">const</span> uint64 memTraffic = <a class="code" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a>(before, after) + <a class="code" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a>(before, after);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">return</span> double(totalQPI) / double(memTraffic);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;}</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a3dfbc795387d801541439b6c035c7b8c"> 2100</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a3dfbc795387d801541439b6c035c7b8c">getNumberOfEvents</a>(<a class="code" href="classPCIeCounterState.html">PCIeCounterState</a> before, <a class="code" href="classPCIeCounterState.html">PCIeCounterState</a> after)</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;{</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="keywordflow">return</span> after.data - before.data;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;}</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="cpucounters_8h_html_a0ea54e2a783ce71cef06350aed099104"><div class="ttname"><a href="cpucounters_8h.html#a0ea54e2a783ce71cef06350aed099104">getNormalizedQPIL1Cycles</a></div><div class="ttdeci">double getNormalizedQPIL1Cycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the ratio of QPI cycles in power saving shutdown mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1082</div></div>
<div class="ttc" id="cpucounters_8h_html_ae6e948c5ad7859e3760336aa02f466bd"><div class="ttname"><a href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd">getSocketIncomingQPILinkBytes</a></div><div class="ttdeci">uint64 getSocketIncomingQPILinkBytes(uint32 socketNr, const SystemCounterState &amp;now)</div><div class="ttdoc">Get estimation of total QPI data traffic for this socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2050</div></div>
<div class="ttc" id="classServerUncorePowerState_html_a45cf07a8d3ce2c48968842554a3854f9"><div class="ttname"><a href="classServerUncorePowerState.html#a45cf07a8d3ce2c48968842554a3854f9">ServerUncorePowerState::getInvariantTSC</a></div><div class="ttdeci">friend uint64 getInvariantTSC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of invariant time stamp counter ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1782</div></div>
<div class="ttc" id="cpucounters_8h_html_af7d9ba0936d7c305d0cc6c2db296a336"><div class="ttname"><a href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a></div><div class="ttdeci">uint64 getQPIClocks(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns QPI LL clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1029</div></div>
<div class="ttc" id="classUncoreCounterState_html_a24fce7df2ee7140db18ecfcd74fe63d1"><div class="ttname"><a href="classUncoreCounterState.html#a24fce7df2ee7140db18ecfcd74fe63d1">UncoreCounterState::getBytesWrittenToMC</a></div><div class="ttdeci">friend uint64 getBytesWrittenToMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes written to DRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1850</div></div>
<div class="ttc" id="structEventSelectRegister_html"><div class="ttname"><a href="structEventSelectRegister.html">EventSelectRegister</a></div><div class="ttdef"><b>Definition:</b> types.h:273</div></div>
<div class="ttc" id="classUncoreCounterState_html_a0f28a32a3edeaecd916ba097aee99d7f"><div class="ttname"><a href="classUncoreCounterState.html#a0f28a32a3edeaecd916ba097aee99d7f">UncoreCounterState::getBytesReadFromMC</a></div><div class="ttdeci">friend uint64 getBytesReadFromMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes read from DRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1838</div></div>
<div class="ttc" id="cpucounters_8h_html_a0b914c4bffa783271c276b29be582370"><div class="ttname"><a href="cpucounters_8h.html#a0b914c4bffa783271c276b29be582370">getAllOutgoingQPILinkBytes</a></div><div class="ttdeci">uint64 getAllOutgoingQPILinkBytes(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of total QPI data+nondata traffic. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2013</div></div>
<div class="ttc" id="classPCM_html_ac0c8d3764ff95840ece17d632de4df9b"><div class="ttname"><a href="classPCM.html#ac0c8d3764ff95840ece17d632de4df9b">PCM::cleanup</a></div><div class="ttdeci">void cleanup()</div><div class="ttdoc">Cleanups resources and stops performance counting. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2294</div></div>
<div class="ttc" id="types_8h_html"><div class="ttname"><a href="types_8h.html">types.h</a></div><div class="ttdoc">Internal type and constant definitions. </div></div>
<div class="ttc" id="classServerUncorePowerState_html_a3c424ad42d2439410d6ffc371335573d"><div class="ttname"><a href="classServerUncorePowerState.html#a3c424ad42d2439410d6ffc371335573d">ServerUncorePowerState::getPCUCounter</a></div><div class="ttdeci">friend uint64 getPCUCounter(uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of power control unit PMU counter (counter meaning depends on the programming: power/perf...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1116</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_ac8dc5ffa64ffebcd21b1d5882ab1fe16"><div class="ttname"><a href="classServerPCICFGUncore.html#ac8dc5ffa64ffebcd21b1d5882ab1fe16">ServerPCICFGUncore::getNumQPIPorts</a></div><div class="ttdeci">uint32 getNumQPIPorts() const </div><div class="ttdoc">Returns the number of detected QPI ports. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:160</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_af5c42a5eb97b97f17a3cb0010bd04642"><div class="ttname"><a href="classServerPCICFGUncore.html#af5c42a5eb97b97f17a3cb0010bd04642">ServerPCICFGUncore::getQPILinkSpeed</a></div><div class="ttdeci">uint64 getQPILinkSpeed(const uint32 linkNr) const </div><div class="ttdoc">Returns the speed of the QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:163</div></div>
<div class="ttc" id="cpucounters_8h_html_a3dfbc795387d801541439b6c035c7b8c"><div class="ttname"><a href="cpucounters_8h.html#a3dfbc795387d801541439b6c035c7b8c">getNumberOfEvents</a></div><div class="ttdeci">uint64 getNumberOfEvents(PCIeCounterState before, PCIeCounterState after)</div><div class="ttdoc">Returns the raw count of PCIe events. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2100</div></div>
<div class="ttc" id="classPCM_html_a56eedaa84893f72b1723f8d580ee3329"><div class="ttname"><a href="classPCM.html#a56eedaa84893f72b1723f8d580ee3329">PCM::good</a></div><div class="ttdeci">bool good()</div><div class="ttdoc">Checks the status of PCM object. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:1342</div></div>
<div class="ttc" id="classPciHandleM_html"><div class="ttname"><a href="classPciHandleM.html">PciHandleM</a></div><div class="ttdef"><b>Definition:</b> pci.h:83</div></div>
<div class="ttc" id="classPCM_html_adb5b4989751f87a17649810a964fa053"><div class="ttname"><a href="classPCM.html#adb5b4989751f87a17649810a964fa053">PCM::setRunState</a></div><div class="ttdeci">void setRunState(int new_state)</div><div class="ttdoc">Set Run State. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:294</div></div>
<div class="ttc" id="classSocketCounterState_html"><div class="ttname"><a href="classSocketCounterState.html">SocketCounterState</a></div><div class="ttdoc">Socket-wide counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1285</div></div>
<div class="ttc" id="classBasicCounterState_html_ace0e3ffc23c20d0eda7663cb7e4899a2"><div class="ttname"><a href="classBasicCounterState.html#ace0e3ffc23c20d0eda7663cb7e4899a2">BasicCounterState::getL3CacheHitsNoSnoop</a></div><div class="ttdeci">friend uint64 getL3CacheHitsNoSnoop(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache hits where no snooping in sibling L2 caches had to be done...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1738</div></div>
<div class="ttc" id="cpucounters_8h_html_a94118e70266db2ed7fc6b8b7b4e2c343"><div class="ttname"><a href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a></div><div class="ttdeci">uint64 getL3CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1685</div></div>
<div class="ttc" id="classPCM_html_a9f142010bb99ba6b81e93895bfa20252"><div class="ttname"><a href="classPCM.html#a9f142010bb99ba6b81e93895bfa20252">PCM::freezeServerUncoreCounters</a></div><div class="ttdeci">void freezeServerUncoreCounters()</div><div class="ttdoc">Freezes uncore event counting (works only on microarchitecture codename SandyBridge-EP and IvyTown) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2785</div></div>
<div class="ttc" id="client__bw_8h_html"><div class="ttname"><a href="client__bw_8h.html">client_bw.h</a></div><div class="ttdoc">Interface to access client bandwidth counters. </div></div>
<div class="ttc" id="cpucounters_8h_html_aca1b1d8ba1679c4a0c394c2647428fd3"><div class="ttname"><a href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a></div><div class="ttdeci">uint64 getIncomingQPILinkBytes(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of QPI data traffic per incoming QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1892</div></div>
<div class="ttc" id="classBasicCounterState_html_a4b1050ca9ccdd66661df556bab70fd0f"><div class="ttname"><a href="classBasicCounterState.html#a4b1050ca9ccdd66661df556bab70fd0f">BasicCounterState::getL3CacheHitsSnoop</a></div><div class="ttdeci">friend uint64 getL3CacheHitsSnoop(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache hits where snooping in sibling L2 caches had to be done. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1752</div></div>
<div class="ttc" id="structFixedEventControlRegister_html"><div class="ttname"><a href="structFixedEventControlRegister.html">FixedEventControlRegister</a></div><div class="ttdef"><b>Definition:</b> types.h:306</div></div>
<div class="ttc" id="classPCM_html_ad4f5ff2c6ce12f0fb4bb5ae1e5bd157a"><div class="ttname"><a href="classPCM.html#ad4f5ff2c6ce12f0fb4bb5ae1e5bd157a">PCM::resetPMU</a></div><div class="ttdeci">void resetPMU()</div><div class="ttdoc">Forces PMU reset. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2243</div></div>
<div class="ttc" id="cpucounters_8h_html_a63896fb0783b57857e3ede0f24083a2a"><div class="ttname"><a href="cpucounters_8h.html#a63896fb0783b57857e3ede0f24083a2a">getSocketCounterState</a></div><div class="ttdeci">INTELPCM_API SocketCounterState getSocketCounterState(uint32 socket)</div><div class="ttdoc">Reads the counter state of a socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2483</div></div>
<div class="ttc" id="classPCM_html_a7ca50e5907ef2b7cf7c81a5e069135f7"><div class="ttname"><a href="classPCM.html#a7ca50e5907ef2b7cf7c81a5e069135f7">PCM::SupportedCPUModels</a></div><div class="ttdeci">SupportedCPUModels</div><div class="ttdoc">Identifiers of supported CPU models. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:596</div></div>
<div class="ttc" id="cpucounters_8h_html_abaca7147e6334e13bbbc718e4a537568"><div class="ttname"><a href="cpucounters_8h.html#abaca7147e6334e13bbbc718e4a537568">getCoreIPC</a></div><div class="ttdeci">double getCoreIPC(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per core cycle for the entire system combining instru...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1491</div></div>
<div class="ttc" id="cpucounters_8h_html_a7ba16714ef7ed547ad8648cb5b9e52f6"><div class="ttname"><a href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a></div><div class="ttdeci">uint64 getL3CacheHits(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes total number of L3 cache hits. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1767</div></div>
<div class="ttc" id="classPCM_html_a88584813a3ef51376efeb22928764786ad60e2f3b64e27eaaa84d2b07fea8e225"><div class="ttname"><a href="classPCM.html#a88584813a3ef51376efeb22928764786ad60e2f3b64e27eaaa84d2b07fea8e225">PCM::INVALID_MODE</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:316</div></div>
<div class="ttc" id="cpucounters_8h_html_a4b1050ca9ccdd66661df556bab70fd0f"><div class="ttname"><a href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a></div><div class="ttdeci">uint64 getL3CacheHitsSnoop(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache hits where snooping in sibling L2 caches had to be done. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1752</div></div>
<div class="ttc" id="classServerPCICFGUncore_html"><div class="ttname"><a href="classServerPCICFGUncore.html">ServerPCICFGUncore</a></div><div class="ttdoc">Object to access uncore counters in a socket/processor with microarchitecture codename SandyBridge-EP...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:80</div></div>
<div class="ttc" id="cpucounters_8h_html_a71af0766460ef7dd3d138ec0d0924eda"><div class="ttname"><a href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a></div><div class="ttdeci">uint64 getDRAMConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by DRAM (measured in internal units) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1146</div></div>
<div class="ttc" id="classBasicCounterState_html_a7b0019d24a77dc05b7e47cb98192fd22"><div class="ttname"><a href="classBasicCounterState.html#a7b0019d24a77dc05b7e47cb98192fd22">BasicCounterState::getIPC</a></div><div class="ttdeci">friend double getIPC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per core cycle (IPC) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1384</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a6746ae55dfb998b5e6f5e50cbe6fb957"><div class="ttname"><a href="classServerPCICFGUncore.html#a6746ae55dfb998b5e6f5e50cbe6fb957">ServerPCICFGUncore::reportQPISpeed</a></div><div class="ttdeci">void reportQPISpeed() const </div><div class="ttdoc">Print QPI Speeds. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:168</div></div>
<div class="ttc" id="structTopologyEntry_html"><div class="ttname"><a href="structTopologyEntry.html">TopologyEntry</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:70</div></div>
<div class="ttc" id="classPCM_html_a88584813a3ef51376efeb22928764786a0f2ff80b85b8f9483c7f03544f73fcbd"><div class="ttname"><a href="classPCM.html#a88584813a3ef51376efeb22928764786a0f2ff80b85b8f9483c7f03544f73fcbd">PCM::EXT_CUSTOM_CORE_EVENTS</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:315</div></div>
<div class="ttc" id="classBasicCounterState_html_a9a351e598b8af26131611ff37b592633"><div class="ttname"><a href="classBasicCounterState.html#a9a351e598b8af26131611ff37b592633">BasicCounterState::getActiveRelativeFrequency</a></div><div class="ttdeci">friend double getActiveRelativeFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency when not in powersaving C0-state (also taking Intel Turbo Boost techn...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1577</div></div>
<div class="ttc" id="classUncoreCounterState_html_a054b949f09283093e1923affa4e58ae8"><div class="ttname"><a href="classUncoreCounterState.html#a054b949f09283093e1923affa4e58ae8">UncoreCounterState::getConsumedEnergy</a></div><div class="ttdeci">friend uint64 getConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by processor, exclusing DRAM (measured in internal units) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1136</div></div>
<div class="ttc" id="classBasicCounterState_html_ac26765efe8a4c7341f40c8ab8bdb9af6"><div class="ttname"><a href="classBasicCounterState.html#ac26765efe8a4c7341f40c8ab8bdb9af6">BasicCounterState::getCyclesLostDueL2CacheMisses</a></div><div class="ttdeci">friend double getCyclesLostDueL2CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Estimates how many core cycles were potentially lost due to missing L2 cache but still hitting L3 cac...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1614</div></div>
<div class="ttc" id="classBasicCounterState_html_a5922acedeec3c1cc67d20670f8ef0518"><div class="ttname"><a href="classBasicCounterState.html#a5922acedeec3c1cc67d20670f8ef0518">BasicCounterState::getL2CacheHitRatio</a></div><div class="ttdeci">friend double getL2CacheHitRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes L2 cache hit ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1635</div></div>
<div class="ttc" id="classPCM_html_a7d302193e0799272e62ba8c5e857a305"><div class="ttname"><a href="classPCM.html#a7d302193e0799272e62ba8c5e857a305">PCM::getQPILinkSpeed</a></div><div class="ttdeci">uint64 getQPILinkSpeed(uint32 socketNr, uint32 linkNr) const </div><div class="ttdoc">Return QPI Link Speed in GBytes/second. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:754</div></div>
<div class="ttc" id="classPCM_html_a88584813a3ef51376efeb22928764786"><div class="ttname"><a href="classPCM.html#a88584813a3ef51376efeb22928764786">PCM::ProgramMode</a></div><div class="ttdeci">ProgramMode</div><div class="ttdoc">Mode of programming (parameter in the program() method) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:312</div></div>
<div class="ttc" id="classBasicCounterState_html_a45cf07a8d3ce2c48968842554a3854f9"><div class="ttname"><a href="classBasicCounterState.html#a45cf07a8d3ce2c48968842554a3854f9">BasicCounterState::getInvariantTSC</a></div><div class="ttdeci">friend uint64 getInvariantTSC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of invariant time stamp counter ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1782</div></div>
<div class="ttc" id="cpucounters_8h_html_a5922acedeec3c1cc67d20670f8ef0518"><div class="ttname"><a href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518">getL2CacheHitRatio</a></div><div class="ttdeci">double getL2CacheHitRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes L2 cache hit ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1635</div></div>
<div class="ttc" id="cpucounters_8h_html_a159a6896f5ef3626b88cdd27a3c15ac0"><div class="ttname"><a href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a></div><div class="ttdeci">double getExecUsage(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per time intervall. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1412</div></div>
<div class="ttc" id="cpucounters_8h_html_a580ae4e465d0f8dd93935ad7af28c095"><div class="ttname"><a href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a></div><div class="ttdeci">uint64 getQPIL1Cycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of QPI cycles in power saving shutdown mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1058</div></div>
<div class="ttc" id="classPCM_html_aa034407ccfd9901b40a64bc29ffb467a"><div class="ttname"><a href="classPCM.html#aa034407ccfd9901b40a64bc29ffb467a">PCM::getMCChannelsPerSocket</a></div><div class="ttdeci">uint32 getMCChannelsPerSocket() const </div><div class="ttdoc">Returns the total number of detected memory channels on all integrated memory controllers per socket...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:681</div></div>
<div class="ttc" id="classBasicCounterState_html_a5411f6d468e66da3357a41f3c0fd1cb2"><div class="ttname"><a href="classBasicCounterState.html#a5411f6d468e66da3357a41f3c0fd1cb2">BasicCounterState::getThermalHeadroom</a></div><div class="ttdeci">int32 getThermalHeadroom() const </div><div class="ttdoc">Returns current thermal headroom below TjMax. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1020</div></div>
<div class="ttc" id="cpucounters_8h_html_af8f7dab111f6b8cbcfa0c1b81e1860fb"><div class="ttname"><a href="cpucounters_8h.html#af8f7dab111f6b8cbcfa0c1b81e1860fb">getConsumedJoules</a></div><div class="ttdeci">double getConsumedJoules(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns Joules consumed by processor (excluding DRAM) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1156</div></div>
<div class="ttc" id="cpucounters_8h_html_a89d4cef9c83db7e76be6a0a2e7351e2e"><div class="ttname"><a href="cpucounters_8h.html#a89d4cef9c83db7e76be6a0a2e7351e2e">getCyclesLostDueL3CacheMisses</a></div><div class="ttdeci">double getCyclesLostDueL3CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Estimates how many core cycles were potentially lost due to L3 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1594</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a42a0e1343ab38371279bf9def8123419"><div class="ttname"><a href="classServerPCICFGUncore.html#a42a0e1343ab38371279bf9def8123419">ServerPCICFGUncore::computeQPISpeed</a></div><div class="ttdeci">uint64 computeQPISpeed(const uint32 ref_core, const int cpumodel)</div><div class="ttdoc">Measures/computes the maximum theoretical QPI link bandwidth speed in GByte/seconds. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3988</div></div>
<div class="ttc" id="cpucounters_8h_html_a054b949f09283093e1923affa4e58ae8"><div class="ttname"><a href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a></div><div class="ttdeci">uint64 getConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by processor, exclusing DRAM (measured in internal units) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1136</div></div>
<div class="ttc" id="cpucounters_8h_html_a9a351e598b8af26131611ff37b592633"><div class="ttname"><a href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633">getActiveRelativeFrequency</a></div><div class="ttdeci">double getActiveRelativeFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency when not in powersaving C0-state (also taking Intel Turbo Boost techn...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1577</div></div>
<div class="ttc" id="classSystemCounterState_html"><div class="ttname"><a href="classSystemCounterState.html">SystemCounterState</a></div><div class="ttdoc">System-wide counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1304</div></div>
<div class="ttc" id="classBasicCounterState_html_a7b03f0cd02862716d717e897032b7885"><div class="ttname"><a href="classBasicCounterState.html#a7b03f0cd02862716d717e897032b7885">BasicCounterState::getL3CacheHitRatio</a></div><div class="ttdeci">friend double getL3CacheHitRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes L3 cache hit ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1663</div></div>
<div class="ttc" id="classPCM_html_a3b1b549672af4c14c00eb7d461c87ac4"><div class="ttname"><a href="classPCM.html#a3b1b549672af4c14c00eb7d461c87ac4">PCM::getPCIeCounterState</a></div><div class="ttdeci">PCIeCounterState getPCIeCounterState(const uint32 socket_)</div><div class="ttdoc">Get the state of PCIe counter(s) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4195</div></div>
<div class="ttc" id="classPCM_html_a794f5852662a2827b34eb16025564c70"><div class="ttname"><a href="classPCM.html#a794f5852662a2827b34eb16025564c70">PCM::getTickCount</a></div><div class="ttdeci">uint64 getTickCount(uint64 multiplier=1000, uint32 core=0)</div><div class="ttdoc">Return TSC timer value in time units. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2424</div></div>
<div class="ttc" id="classBasicCounterState_html_a98aa8d4eb21e8a992fc181d65018e5ce"><div class="ttname"><a href="classBasicCounterState.html#a98aa8d4eb21e8a992fc181d65018e5ce">BasicCounterState::getCoreCStateResidency</a></div><div class="ttdeci">friend double getCoreCStateResidency(int state, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes residency in the core C-state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1795</div></div>
<div class="ttc" id="cpucounters_8h_html_aa5a7caff83891aafc6e9eb20501170cc"><div class="ttname"><a href="cpucounters_8h.html#aa5a7caff83891aafc6e9eb20501170cc">getNormalizedQPIL0pTxCycles</a></div><div class="ttdeci">double getNormalizedQPIL0pTxCycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the ratio of QPI cycles in power saving half-lane mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1070</div></div>
<div class="ttc" id="cpucounters_8h_html_acdac5d9d7a5a6496d90b0681badc26b3"><div class="ttname"><a href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a></div><div class="ttdeci">uint64 getQPIL0pTxCycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of QPI cycles in power saving half-lane mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1047</div></div>
<div class="ttc" id="classServerUncorePowerState_html_acdac5d9d7a5a6496d90b0681badc26b3"><div class="ttname"><a href="classServerUncorePowerState.html#acdac5d9d7a5a6496d90b0681badc26b3">ServerUncorePowerState::getQPIL0pTxCycles</a></div><div class="ttdeci">friend uint64 getQPIL0pTxCycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of QPI cycles in power saving half-lane mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1047</div></div>
<div class="ttc" id="cpucounters_8h_html_a98aa8d4eb21e8a992fc181d65018e5ce"><div class="ttname"><a href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a></div><div class="ttdeci">double getCoreCStateResidency(int state, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes residency in the core C-state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1795</div></div>
<div class="ttc" id="cpucounters_8h_html_a3641dfa6466049072b8937ee64b03738"><div class="ttname"><a href="cpucounters_8h.html#a3641dfa6466049072b8937ee64b03738">getCoreCounterState</a></div><div class="ttdeci">INTELPCM_API CoreCounterState getCoreCounterState(uint32 core)</div><div class="ttdoc">Reads the counter state of a (logical) core. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2491</div></div>
<div class="ttc" id="classPCM_html_a617beda55da4de32593a7aa925fe1f02"><div class="ttname"><a href="classPCM.html#a617beda55da4de32593a7aa925fe1f02">PCM::unfreezeServerUncoreCounters</a></div><div class="ttdeci">void unfreezeServerUncoreCounters()</div><div class="ttdoc">Unfreezes uncore event counting (works only on microarchitecture codename SandyBridge-EP and IvyTown)...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2793</div></div>
<div class="ttc" id="cpucounters_8h_html_aeb1baf7feb391c0512dc378a9fd66a17"><div class="ttname"><a href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a></div><div class="ttdeci">uint64 getDRAMClocks(uint32 channel, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns DRAM clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1093</div></div>
<div class="ttc" id="classPCM_html_a3a30cec6e4e7a78ec964d194e3844637"><div class="ttname"><a href="classPCM.html#a3a30cec6e4e7a78ec964d194e3844637">PCM::programServerUncorePowerMetrics</a></div><div class="ttdeci">ErrorCode programServerUncorePowerMetrics(int mc_profile, int pcu_profile, int *freq_bands=NULL)</div><div class="ttdoc">Programs uncore power/energy counters on microarchitectures codename SandyBridge-EP and IvyTown...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2617</div></div>
<div class="ttc" id="classSystemCounterState_html_ac7b1863133a9a711117fcb8b68d2d773"><div class="ttname"><a href="classSystemCounterState.html#ac7b1863133a9a711117fcb8b68d2d773">SystemCounterState::getOutgoingQPILinkUtilization</a></div><div class="ttdeci">friend double getOutgoingQPILinkUtilization(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get utilization of outgoing QPI link (0..1) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1931</div></div>
<div class="ttc" id="classPCM_html_ae797dcf2d4162a37a3535dd5aa48f87f"><div class="ttname"><a href="classPCM.html#ae797dcf2d4162a37a3535dd5aa48f87f">PCM::getCPUModel</a></div><div class="ttdeci">uint32 getCPUModel()</div><div class="ttdoc">Reads CPU model id. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:622</div></div>
<div class="ttc" id="classBasicCounterState_html_aa398facfd523b7dcdbf827a74970a88c"><div class="ttname"><a href="classBasicCounterState.html#aa398facfd523b7dcdbf827a74970a88c">BasicCounterState::getAverageFrequency</a></div><div class="ttdeci">friend double getAverageFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency also taking Intel Turbo Boost technology into account. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1527</div></div>
<div class="ttc" id="structPCM_1_1CustomCoreEventDescription_html"><div class="ttname"><a href="structPCM_1_1CustomCoreEventDescription.html">PCM::CustomCoreEventDescription</a></div><div class="ttdoc">Custom Core event description. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:334</div></div>
<div class="ttc" id="cpucounters_8h_html_a5e34f7b0326dda86b54fcb7bb84a0b38"><div class="ttname"><a href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a></div><div class="ttdeci">double getPackageCStateResidency(int state, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes residency in the package C-state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1825</div></div>
<div class="ttc" id="cpucounters_8h_html_a1f83dc2b6cd3a1efcd850003e26c6404"><div class="ttname"><a href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a></div><div class="ttdeci">uint64 getAllIncomingQPILinkBytes(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of total QPI data traffic. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1991</div></div>
<div class="ttc" id="cpucounters_8h_html_ac225ab9b4b77afb098ddefd13025d14c"><div class="ttname"><a href="cpucounters_8h.html#ac225ab9b4b77afb098ddefd13025d14c">getSystemCounterState</a></div><div class="ttdeci">INTELPCM_API SystemCounterState getSystemCounterState()</div><div class="ttdoc">Reads the counter state of the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2475</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_acd6e859dd5eaaadf97d2c59ae70ac4a7"><div class="ttname"><a href="classServerPCICFGUncore.html#acd6e859dd5eaaadf97d2c59ae70ac4a7">ServerPCICFGUncore::program</a></div><div class="ttdeci">void program()</div><div class="ttdoc">Program performance counters (disables programming power counters) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3565</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a7aaff7ae03c8189de550215cef3b39f7"><div class="ttname"><a href="classServerPCICFGUncore.html#a7aaff7ae03c8189de550215cef3b39f7">ServerPCICFGUncore::getQPIL0pTxCycles</a></div><div class="ttdeci">uint64 getQPIL0pTxCycles(uint32 port)</div><div class="ttdoc">Get number cycles on a QPI port when the link was in a power saving half-lane mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3867</div></div>
<div class="ttc" id="classUncoreCounterState_html"><div class="ttname"><a href="classUncoreCounterState.html">UncoreCounterState</a></div><div class="ttdoc">Basic uncore counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1181</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a91352764d2ab70889388f61d48852694"><div class="ttname"><a href="classServerPCICFGUncore.html#a91352764d2ab70889388f61d48852694">ServerPCICFGUncore::enableJKTWorkaround</a></div><div class="ttdeci">void enableJKTWorkaround(bool enable)</div><div class="ttdoc">Enable correct counting of various LLC events (with memory access perf penalty) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3953</div></div>
<div class="ttc" id="cpucounters_8h_html_a24fce7df2ee7140db18ecfcd74fe63d1"><div class="ttname"><a href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a></div><div class="ttdeci">uint64 getBytesWrittenToMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes written to DRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1850</div></div>
<div class="ttc" id="structPCM_1_1ExtendedCustomCoreEventDescription_html"><div class="ttname"><a href="structPCM_1_1ExtendedCustomCoreEventDescription.html">PCM::ExtendedCustomCoreEventDescription</a></div><div class="ttdoc">Extended custom core event description. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:348</div></div>
<div class="ttc" id="classPCM_html_a6a1e83a12ad11bbefde28ef0363e2663"><div class="ttname"><a href="classPCM.html#a6a1e83a12ad11bbefde28ef0363e2663">PCM::getPackageThermalSpecPower</a></div><div class="ttdeci">int32 getPackageThermalSpecPower() const </div><div class="ttdoc">Returns thermal specification power of the package domain in Watt. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:761</div></div>
<div class="ttc" id="classPCIeCounterState_html_a3dfbc795387d801541439b6c035c7b8c"><div class="ttname"><a href="classPCIeCounterState.html#a3dfbc795387d801541439b6c035c7b8c">PCIeCounterState::getNumberOfEvents</a></div><div class="ttdeci">friend uint64 getNumberOfEvents(PCIeCounterState before, PCIeCounterState after)</div><div class="ttdoc">Returns the raw count of PCIe events. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2100</div></div>
<div class="ttc" id="cpucounters_8h_html_a963d78be64ccddb4f7686405ef4df9c1"><div class="ttname"><a href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1">getActiveAverageFrequency</a></div><div class="ttdeci">double getActiveAverageFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency when not in powersaving C0-state (also taking Intel Turbo Boost techn...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1544</div></div>
<div class="ttc" id="cpucounters_8h_html_a806e72bc51f05acc4af0667ca3334242"><div class="ttname"><a href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242">getRelativeFrequency</a></div><div class="ttdeci">double getRelativeFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency also taking Intel Turbo Boost technology into account. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1561</div></div>
<div class="ttc" id="classPCM_html_a0d5153c7ec05003da7d20aeea737113e"><div class="ttname"><a href="classPCM.html#a0d5153c7ec05003da7d20aeea737113e">PCM::getTickCountRDTSCP</a></div><div class="ttdeci">uint64 getTickCountRDTSCP(uint64 multiplier=1000)</div><div class="ttdoc">Return TSC timer value in time units using rdtscp instruction from current core. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2470</div></div>
<div class="ttc" id="cpucounters_8h_html_aed082cc97dbad35e1633823e582afa0f"><div class="ttname"><a href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a></div><div class="ttdeci">uint64 getMCCounter(uint32 channel, uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of memory controller PMU counter (counter meaning depends on the programming: power/perfo...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1105</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_abcd9990a39fb245bb552e6cae4922305"><div class="ttname"><a href="classServerPCICFGUncore.html#abcd9990a39fb245bb552e6cae4922305">ServerPCICFGUncore::getQPILLCounter</a></div><div class="ttdeci">uint64 getQPILLCounter(uint32 port, uint32 counter)</div><div class="ttdoc">Direct read of QPI LL PMU counter (counter meaning depends on the programming: power/performance/etc)...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3927</div></div>
<div class="ttc" id="classPCM_html_acf164b6843e71199d6c26544df108799"><div class="ttname"><a href="classPCM.html#acf164b6843e71199d6c26544df108799">PCM::getQPILinksPerSocket</a></div><div class="ttdeci">uint64 getQPILinksPerSocket() const </div><div class="ttdoc">Returns the number of Intel(r) Quick Path Interconnect(tm) links per socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:638</div></div>
<div class="ttc" id="classBasicCounterState_html_a159a6896f5ef3626b88cdd27a3c15ac0"><div class="ttname"><a href="classBasicCounterState.html#a159a6896f5ef3626b88cdd27a3c15ac0">BasicCounterState::getExecUsage</a></div><div class="ttdeci">friend double getExecUsage(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per time intervall. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1412</div></div>
<div class="ttc" id="classPCIeCounterState_html"><div class="ttname"><a href="classPCIeCounterState.html">PCIeCounterState</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:183</div></div>
<div class="ttc" id="cpucounters_8h_html_a7b03f0cd02862716d717e897032b7885"><div class="ttname"><a href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885">getL3CacheHitRatio</a></div><div class="ttdeci">double getL3CacheHitRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes L3 cache hit ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1663</div></div>
<div class="ttc" id="classPCM_html_a55f62ca7429cf9a72db8c0a21931374a"><div class="ttname"><a href="classPCM.html#a55f62ca7429cf9a72db8c0a21931374a">PCM::programPCIeCounters</a></div><div class="ttdeci">void programPCIeCounters(const PCIeEventCode event_, const uint32 tid_=0, const uint32 miss_=0)</div><div class="ttdoc">Program uncore PCIe monitoring event(s) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4153</div></div>
<div class="ttc" id="cpucounters_8h_html_aa398facfd523b7dcdbf827a74970a88c"><div class="ttname"><a href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c">getAverageFrequency</a></div><div class="ttdeci">double getAverageFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency also taking Intel Turbo Boost technology into account. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1527</div></div>
<div class="ttc" id="cpucounters_8h_html_a7e5434dba3a810501f289329e52b889d"><div class="ttname"><a href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d">getIORequestBytesFromMC</a></div><div class="ttdeci">uint64 getIORequestBytesFromMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes of read/write requests from all IO sources. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1862</div></div>
<div class="ttc" id="classPCM_html_a5e1c78309aae01a2706d1fc39766e90f"><div class="ttname"><a href="classPCM.html#a5e1c78309aae01a2706d1fc39766e90f">PCM::getNumSockets</a></div><div class="ttdeci">uint32 getNumSockets()</div><div class="ttdoc">Reads number of sockets (CPUs) in the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3124</div></div>
<div class="ttc" id="cpucounters_8h_html_ace0e3ffc23c20d0eda7663cb7e4899a2"><div class="ttname"><a href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a></div><div class="ttdeci">uint64 getL3CacheHitsNoSnoop(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache hits where no snooping in sibling L2 caches had to be done...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1738</div></div>
<div class="ttc" id="classPCM_html_a5fc8a2d2073ce855558d201883ecf3cd"><div class="ttname"><a href="classPCM.html#a5fc8a2d2073ce855558d201883ecf3cd">PCM::getRunState</a></div><div class="ttdeci">int getRunState(void)</div><div class="ttdoc">Returns program&#39;s Run State. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:300</div></div>
<div class="ttc" id="classPCM_html_a670b4ea8dce3252539f5e55f94ab932f"><div class="ttname"><a href="classPCM.html#a670b4ea8dce3252539f5e55f94ab932f">PCM::getNumOnlineCores</a></div><div class="ttdeci">uint32 getNumOnlineCores()</div><div class="ttdoc">Reads number of online logical cores in the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3119</div></div>
<div class="ttc" id="cpucounters_8h_html_a6bdb34d102d7353421bd878da7b9ef23"><div class="ttname"><a href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a></div><div class="ttdeci">uint64 getOutgoingQPILinkBytes(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of QPI (data+nondata) traffic per outgoing QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1971</div></div>
<div class="ttc" id="classPCM_html_a3cb1bbca3a6ddce86dbbf8c944216710"><div class="ttname"><a href="classPCM.html#a3cb1bbca3a6ddce86dbbf8c944216710">PCM::getSMT</a></div><div class="ttdeci">bool getSMT()</div><div class="ttdoc">Checks if SMT (HyperThreading) is enabled. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3134</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a379962b379f637f3b752f7fb4666c7e7"><div class="ttname"><a href="classServerPCICFGUncore.html#a379962b379f637f3b752f7fb4666c7e7">ServerPCICFGUncore::unfreezeCounters</a></div><div class="ttdeci">void unfreezeCounters()</div><div class="ttdoc">Unfreezes event counting. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3843</div></div>
<div class="ttc" id="classBasicCounterState_html_aaa3691b803702deec828d0d8d8a8f326"><div class="ttname"><a href="classBasicCounterState.html#aaa3691b803702deec828d0d8d8a8f326">BasicCounterState::getRefCycles</a></div><div class="ttdeci">friend uint64 getRefCycles(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number of reference clock cycles while clock signal on the core is running. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1465</div></div>
<div class="ttc" id="classServerUncorePowerState_html_aed082cc97dbad35e1633823e582afa0f"><div class="ttname"><a href="classServerUncorePowerState.html#aed082cc97dbad35e1633823e582afa0f">ServerUncorePowerState::getMCCounter</a></div><div class="ttdeci">friend uint64 getMCCounter(uint32 channel, uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of memory controller PMU counter (counter meaning depends on the programming: power/perfo...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1105</div></div>
<div class="ttc" id="cpucounters_8h_html_a45cf07a8d3ce2c48968842554a3854f9"><div class="ttname"><a href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a></div><div class="ttdeci">uint64 getInvariantTSC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of invariant time stamp counter ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1782</div></div>
<div class="ttc" id="classPCM_html_a88584813a3ef51376efeb22928764786a0e861144f482697cfa423b012ed42451"><div class="ttname"><a href="classPCM.html#a88584813a3ef51376efeb22928764786a0e861144f482697cfa423b012ed42451">PCM::DEFAULT_EVENTS</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:313</div></div>
<div class="ttc" id="pci_8h_html"><div class="ttname"><a href="pci_8h.html">pci.h</a></div><div class="ttdoc">Low level interface to access PCI configuration space. </div></div>
<div class="ttc" id="classSystemCounterState_html_aca1b1d8ba1679c4a0c394c2647428fd3"><div class="ttname"><a href="classSystemCounterState.html#aca1b1d8ba1679c4a0c394c2647428fd3">SystemCounterState::getIncomingQPILinkBytes</a></div><div class="ttdeci">friend uint64 getIncomingQPILinkBytes(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of QPI data traffic per incoming QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1892</div></div>
<div class="ttc" id="classBasicCounterState_html_a291eeab262fdb93de08cdfdf50dbad58"><div class="ttname"><a href="classBasicCounterState.html#a291eeab262fdb93de08cdfdf50dbad58">BasicCounterState::getL2CacheMisses</a></div><div class="ttdeci">friend uint64 getL2CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L2 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1699</div></div>
<div class="ttc" id="cpucounters_8h_html_aaa3691b803702deec828d0d8d8a8f326"><div class="ttname"><a href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a></div><div class="ttdeci">uint64 getRefCycles(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number of reference clock cycles while clock signal on the core is running. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1465</div></div>
<div class="ttc" id="classBasicCounterState_html_a459367d7877d09594c2ecd85e04cae61"><div class="ttname"><a href="classBasicCounterState.html#a459367d7877d09594c2ecd85e04cae61">BasicCounterState::getL2CacheHits</a></div><div class="ttdeci">friend uint64 getL2CacheHits(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L2 cache hits. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1719</div></div>
<div class="ttc" id="cpucounters_8h_html_acd430f703c67fc7dc0829d624ba657af"><div class="ttname"><a href="cpucounters_8h.html#acd430f703c67fc7dc0829d624ba657af">getPCUClocks</a></div><div class="ttdeci">uint64 getPCUClocks(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns clock ticks of power control unit. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1126</div></div>
<div class="ttc" id="classServerUncorePowerState_html_a71af0766460ef7dd3d138ec0d0924eda"><div class="ttname"><a href="classServerUncorePowerState.html#a71af0766460ef7dd3d138ec0d0924eda">ServerUncorePowerState::getDRAMConsumedEnergy</a></div><div class="ttdeci">friend uint64 getDRAMConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by DRAM (measured in internal units) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1146</div></div>
<div class="ttc" id="classPCM_html_abfe7e00fc21589083988d3f1f7b0ade3"><div class="ttname"><a href="classPCM.html#abfe7e00fc21589083988d3f1f7b0ade3">PCM::getOriginalCPUModel</a></div><div class="ttdeci">uint32 getOriginalCPUModel()</div><div class="ttdoc">Reads original CPU model id. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:626</div></div>
<div class="ttc" id="width__extender_8h_html"><div class="ttname"><a href="width__extender_8h.html">width_extender.h</a></div><div class="ttdoc">Provides 64-bit "virtual" counters from underlying 32-bit HW counters. </div></div>
<div class="ttc" id="classPCM_html_aaab4b857581f55723fc3959cf6c8cd91"><div class="ttname"><a href="classPCM.html#aaab4b857581f55723fc3959cf6c8cd91">PCM::setOutput</a></div><div class="ttdeci">void setOutput(const std::string filename)</div><div class="ttdoc">Redirects output destination to provided file, instead of std::cout. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2276</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_ad4bda64cc17432d44ee8e380a735b795"><div class="ttname"><a href="classServerPCICFGUncore.html#ad4bda64cc17432d44ee8e380a735b795">ServerPCICFGUncore::freezeCounters</a></div><div class="ttdeci">void freezeCounters()</div><div class="ttdoc">Freezes event counting. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3831</div></div>
<div class="ttc" id="classPCM_html_a5e4cabfe4223f1d2e7e1e0da8b1179b3"><div class="ttname"><a href="classPCM.html#a5e4cabfe4223f1d2e7e1e0da8b1179b3">PCM::initWinRing0Lib</a></div><div class="ttdeci">static bool initWinRing0Lib()</div><div class="ttdoc">Loads and initializes Winring0 third party library for access to processor model specific and PCI con...</div></div>
<div class="ttc" id="classPCM_html_aa1d6e2bcea705f051cd39e04070139c1"><div class="ttname"><a href="classPCM.html#aa1d6e2bcea705f051cd39e04070139c1">PCM::getSocketId</a></div><div class="ttdeci">int32 getSocketId(uint32 core_id)</div><div class="ttdoc">Determines socket of given core. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:631</div></div>
<div class="ttc" id="classBasicCounterState_html_a806e72bc51f05acc4af0667ca3334242"><div class="ttname"><a href="classBasicCounterState.html#a806e72bc51f05acc4af0667ca3334242">BasicCounterState::getRelativeFrequency</a></div><div class="ttdeci">friend double getRelativeFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency also taking Intel Turbo Boost technology into account. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1561</div></div>
<div class="ttc" id="classPCM_html_a4261a7c1980c16cfe289856401aa3bee"><div class="ttname"><a href="classPCM.html#a4261a7c1980c16cfe289856401aa3bee">PCM::allowMultipleInstances</a></div><div class="ttdeci">void allowMultipleInstances()</div><div class="ttdoc">Call it before program() to allow multiple running instances of PCM on the same system. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:306</div></div>
<div class="ttc" id="classServerUncorePowerState_html_a054b949f09283093e1923affa4e58ae8"><div class="ttname"><a href="classServerUncorePowerState.html#a054b949f09283093e1923affa4e58ae8">ServerUncorePowerState::getConsumedEnergy</a></div><div class="ttdeci">friend uint64 getConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by processor, exclusing DRAM (measured in internal units) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1136</div></div>
<div class="ttc" id="classPCM_html_a8f649340620d5ca7514d26861d9d79a4"><div class="ttname"><a href="classPCM.html#a8f649340620d5ca7514d26861d9d79a4">PCM::getPackageMaximumPower</a></div><div class="ttdeci">int32 getPackageMaximumPower() const </div><div class="ttdoc">Returns maximum power derived from electrical spec of the package domain in Watt. ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:767</div></div>
<div class="ttc" id="classServerUncorePowerState_html_aeb1baf7feb391c0512dc378a9fd66a17"><div class="ttname"><a href="classServerUncorePowerState.html#aeb1baf7feb391c0512dc378a9fd66a17">ServerUncorePowerState::getDRAMClocks</a></div><div class="ttdeci">friend uint64 getDRAMClocks(uint32 channel, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns DRAM clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1093</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_af53af91d9172cd124e455e500d6c5622"><div class="ttname"><a href="classServerPCICFGUncore.html#af53af91d9172cd124e455e500d6c5622">ServerPCICFGUncore::program_power_metrics</a></div><div class="ttdeci">void program_power_metrics(int mc_profile)</div><div class="ttdoc">Program power counters (disables programming performance counters) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3714</div></div>
<div class="ttc" id="cpucounters_8h_html_a5a3275c4f489a475f1658f4546567af4"><div class="ttname"><a href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a></div><div class="ttdeci">uint64 getCycles(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number core clock cycles when signal on a specific core is running (not halted) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1449</div></div>
<div class="ttc" id="classPCM_html_ade92d30321a659ca54d423eaf0e30e12"><div class="ttname"><a href="classPCM.html#ade92d30321a659ca54d423eaf0e30e12">PCM::getAllCounterStates</a></div><div class="ttdeci">void getAllCounterStates(SystemCounterState &amp;systemState, std::vector&lt; SocketCounterState &gt; &amp;socketStates, std::vector&lt; CoreCounterState &gt; &amp;coreStates)</div><div class="ttdoc">Reads all counter states (including system, sockets and cores) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3065</div></div>
<div class="ttc" id="classUncoreCounterState_html_a5e34f7b0326dda86b54fcb7bb84a0b38"><div class="ttname"><a href="classUncoreCounterState.html#a5e34f7b0326dda86b54fcb7bb84a0b38">UncoreCounterState::getPackageCStateResidency</a></div><div class="ttdeci">friend double getPackageCStateResidency(int state, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes residency in the package C-state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1825</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_ad66687e98d1b74c145b79fedefc07d15"><div class="ttname"><a href="classServerPCICFGUncore.html#ad66687e98d1b74c145b79fedefc07d15">ServerPCICFGUncore::getMCCounter</a></div><div class="ttdeci">uint64 getMCCounter(uint32 channel, uint32 counter)</div><div class="ttdoc">Direct read of memory controller PMU counter (counter meaning depends on the programming: power/perfo...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3901</div></div>
<div class="ttc" id="cpucounters_8h_html_a0ba3a5b71b7dd6b84c345f8cbc795b1c"><div class="ttname"><a href="cpucounters_8h.html#a0ba3a5b71b7dd6b84c345f8cbc795b1c">getIncomingQPILinkUtilization</a></div><div class="ttdeci">double getIncomingQPILinkUtilization(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get data utilization of incoming QPI link (0..1) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1910</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_ae5bc4e8e1003ed74fdd3c641e6ac78a5"><div class="ttname"><a href="classServerPCICFGUncore.html#ae5bc4e8e1003ed74fdd3c641e6ac78a5">ServerPCICFGUncore::getQPIClocks</a></div><div class="ttdeci">uint64 getQPIClocks(uint32 port)</div><div class="ttdoc">Get number of QPI LL clocks on a QPI port. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3855</div></div>
<div class="ttc" id="classPCM_html_a7a895ed54c20b38bbfbb47c9246c2e95"><div class="ttname"><a href="classPCM.html#a7a895ed54c20b38bbfbb47c9246c2e95">PCM::getUArchCodename</a></div><div class="ttdeci">const char * getUArchCodename(int32 cpu_model_=-1) const </div><div class="ttdoc">Get a string describing the codename of the processor microarchitecture. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2176</div></div>
<div class="ttc" id="cpucounters_8h_html_abaa9d828b52f41866bf7dc8ff491a62e"><div class="ttname"><a href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e">getNumberOfCustomEvents</a></div><div class="ttdeci">uint64 getNumberOfCustomEvents(int32 eventCounterNr, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of occured custom core events. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1877</div></div>
<div class="ttc" id="classPCM_html_a3279d88bbd5c2eab06c9c6cb6248c3c7"><div class="ttname"><a href="classPCM.html#a3279d88bbd5c2eab06c9c6cb6248c3c7">PCM::getCPUBrandString</a></div><div class="ttdeci">static std::string getCPUBrandString()</div><div class="ttdoc">Get Brand string of processor. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2026</div></div>
<div class="ttc" id="classCounterWidthExtender_html"><div class="ttname"><a href="classCounterWidthExtender.html">CounterWidthExtender</a></div><div class="ttdef"><b>Definition:</b> width_extender.h:39</div></div>
<div class="ttc" id="classServerUncorePowerState_html_af7d9ba0936d7c305d0cc6c2db296a336"><div class="ttname"><a href="classServerUncorePowerState.html#af7d9ba0936d7c305d0cc6c2db296a336">ServerUncorePowerState::getQPIClocks</a></div><div class="ttdeci">friend uint64 getQPIClocks(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns QPI LL clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1029</div></div>
<div class="ttc" id="cpucounters_8h_html_ab6f97a3386ac2d35dfd61148acde0a53"><div class="ttname"><a href="cpucounters_8h.html#ab6f97a3386ac2d35dfd61148acde0a53">getDRAMConsumedJoules</a></div><div class="ttdeci">double getDRAMConsumedJoules(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns Joules consumed by DRAM. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1169</div></div>
<div class="ttc" id="cpucounters_8h_html_af124718a7620c7bbca81232c2149f771"><div class="ttname"><a href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a></div><div class="ttdeci">uint64 getInstructionsRetired(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number of retired instructions. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1400</div></div>
<div class="ttc" id="classPCM_html_ad14572fb187f2c0121843fb50f886ebd"><div class="ttname"><a href="classPCM.html#ad14572fb187f2c0121843fb50f886ebd">PCM::getNumCores</a></div><div class="ttdeci">uint32 getNumCores()</div><div class="ttdoc">Reads number of logical cores in the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3114</div></div>
<div class="ttc" id="classPCM_html"><div class="ttname"><a href="classPCM.html">PCM</a></div><div class="ttdoc">CPU Performance Monitor. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:210</div></div>
<div class="ttc" id="classPCM_html_a1aa93f0a086f91b63c9a3f5375ef2f07"><div class="ttname"><a href="classPCM.html#a1aa93f0a086f91b63c9a3f5375ef2f07">PCM::getPackageMinimumPower</a></div><div class="ttdeci">int32 getPackageMinimumPower() const </div><div class="ttdoc">Returns minimum power derived from electrical spec of the package domain in Watt. ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:764</div></div>
<div class="ttc" id="classUncoreCounterState_html_a7e5434dba3a810501f289329e52b889d"><div class="ttname"><a href="classUncoreCounterState.html#a7e5434dba3a810501f289329e52b889d">UncoreCounterState::getIORequestBytesFromMC</a></div><div class="ttdeci">friend uint64 getIORequestBytesFromMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes of read/write requests from all IO sources. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1862</div></div>
<div class="ttc" id="classBasicCounterState_html_a94118e70266db2ed7fc6b8b7b4e2c343"><div class="ttname"><a href="classBasicCounterState.html#a94118e70266db2ed7fc6b8b7b4e2c343">BasicCounterState::getL3CacheMisses</a></div><div class="ttdeci">friend uint64 getL3CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1685</div></div>
<div class="ttc" id="classBasicCounterState_html_a89d4cef9c83db7e76be6a0a2e7351e2e"><div class="ttname"><a href="classBasicCounterState.html#a89d4cef9c83db7e76be6a0a2e7351e2e">BasicCounterState::getCyclesLostDueL3CacheMisses</a></div><div class="ttdeci">friend double getCyclesLostDueL3CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Estimates how many core cycles were potentially lost due to L3 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1594</div></div>
<div class="ttc" id="classPCM_html_a826a1f946b8a8d461a25ea7d11f8646e"><div class="ttname"><a href="classPCM.html#a826a1f946b8a8d461a25ea7d11f8646e">PCM::getNominalFrequency</a></div><div class="ttdeci">uint64 getNominalFrequency()</div><div class="ttdoc">Reads the nominal core frequency. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3139</div></div>
<div class="ttc" id="cpucounters_8h_html_ac7b1863133a9a711117fcb8b68d2d773"><div class="ttname"><a href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a></div><div class="ttdeci">double getOutgoingQPILinkUtilization(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get utilization of outgoing QPI link (0..1) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1931</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a089f11fc46ab836884cc31b5b4ac08e3"><div class="ttname"><a href="classServerPCICFGUncore.html#a089f11fc46ab836884cc31b5b4ac08e3">ServerPCICFGUncore::getImcWrites</a></div><div class="ttdeci">uint64 getImcWrites()</div><div class="ttdoc">Get the number of integrated controller writes (in cache lines) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3682</div></div>
<div class="ttc" id="cpucounters_8h_html_a3c424ad42d2439410d6ffc371335573d"><div class="ttname"><a href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a></div><div class="ttdeci">uint64 getPCUCounter(uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of power control unit PMU counter (counter meaning depends on the programming: power/perf...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1116</div></div>
<div class="ttc" id="classBasicCounterState_html_af124718a7620c7bbca81232c2149f771"><div class="ttname"><a href="classBasicCounterState.html#af124718a7620c7bbca81232c2149f771">BasicCounterState::getInstructionsRetired</a></div><div class="ttdeci">friend uint64 getInstructionsRetired(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number of retired instructions. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1400</div></div>
<div class="ttc" id="classPCM_html_abae9577a1a172c944d133bef10683825"><div class="ttname"><a href="classPCM.html#abae9577a1a172c944d133bef10683825">PCM::program</a></div><div class="ttdeci">ErrorCode program(const ProgramMode mode_=DEFAULT_EVENTS, const void *parameter_=NULL)</div><div class="ttdoc">Programs performance counters. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:1407</div></div>
<div class="ttc" id="classPCM_html_a88ae0774aeb6d92f7533ff4bdfe77787"><div class="ttname"><a href="classPCM.html#a88ae0774aeb6d92f7533ff4bdfe77787">PCM::getPCUFrequency</a></div><div class="ttdeci">uint64 getPCUFrequency() const </div><div class="ttdoc">Returns the frequency of Power Control Unit. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:725</div></div>
<div class="ttc" id="classPCM_html_aaad049657e9c017c4b5840f36958b1f1"><div class="ttname"><a href="classPCM.html#aaad049657e9c017c4b5840f36958b1f1">PCM::getThreadsPerCore</a></div><div class="ttdeci">uint32 getThreadsPerCore()</div><div class="ttdoc">Reads how many hardware threads has a physical core "Hardware thread" is a logical core in a differen...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3129</div></div>
<div class="ttc" id="classPCM_html_a81ed5d9b2caa55615bc9b6c4e65eccb4"><div class="ttname"><a href="classPCM.html#a81ed5d9b2caa55615bc9b6c4e65eccb4">PCM::getJoulesPerEnergyUnit</a></div><div class="ttdeci">double getJoulesPerEnergyUnit() const </div><div class="ttdoc">Returns how many joules are in an internal processor energy unit. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:758</div></div>
<div class="ttc" id="classPCM_html_af8bcd9d89ee64d8effdf968132f3b842"><div class="ttname"><a href="classPCM.html#af8bcd9d89ee64d8effdf968132f3b842">PCM::restoreOutput</a></div><div class="ttdeci">void restoreOutput()</div><div class="ttdoc">Restores output, closes output file if opened. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2283</div></div>
<div class="ttc" id="classClientBW_html"><div class="ttname"><a href="classClientBW.html">ClientBW</a></div><div class="ttdef"><b>Definition:</b> client_bw.h:39</div></div>
<div class="ttc" id="classSafeMsrHandle_html"><div class="ttname"><a href="classSafeMsrHandle.html">SafeMsrHandle</a></div><div class="ttdef"><b>Definition:</b> msr.h:62</div></div>
<div class="ttc" id="cpucounters_8h_html_a291eeab262fdb93de08cdfdf50dbad58"><div class="ttname"><a href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a></div><div class="ttdeci">uint64 getL2CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L2 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1699</div></div>
<div class="ttc" id="classPCM_html_ae7ce6762ad3607dbb839b6698f94697a"><div class="ttname"><a href="classPCM.html#ae7ce6762ad3607dbb839b6698f94697a">PCM::getErrorMessage</a></div><div class="ttdeci">const std::string &amp; getErrorMessage() const </div><div class="ttdoc">Returns the error message. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:465</div></div>
<div class="ttc" id="cpucounters_8h_html_a7b0019d24a77dc05b7e47cb98192fd22"><div class="ttname"><a href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a></div><div class="ttdeci">double getIPC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per core cycle (IPC) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1384</div></div>
<div class="ttc" id="classServerUncorePowerState_html_a2680b28b8d92da4cf74a3a1c59bf7c1d"><div class="ttname"><a href="classServerUncorePowerState.html#a2680b28b8d92da4cf74a3a1c59bf7c1d">ServerUncorePowerState::getPackageThermalHeadroom</a></div><div class="ttdeci">int32 getPackageThermalHeadroom() const </div><div class="ttdoc">Returns current thermal headroom below TjMax. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1261</div></div>
<div class="ttc" id="classPCM_html_af43f3a1e920264467a3855ced5f8162b"><div class="ttname"><a href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">PCM::isCoreCStateResidencySupported</a></div><div class="ttdeci">bool isCoreCStateResidencySupported(int state)</div><div class="ttdoc">Returns true if the specified core C-state residency metric is supported. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:270</div></div>
<div class="ttc" id="classServerUncorePowerState_html"><div class="ttname"><a href="classServerUncorePowerState.html">ServerUncorePowerState</a></div><div class="ttdoc">Server uncore power counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1232</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a52ceae2a7ca82345dbf0b9333ca12038"><div class="ttname"><a href="classServerPCICFGUncore.html#a52ceae2a7ca82345dbf0b9333ca12038">ServerPCICFGUncore::getNumMCChannels</a></div><div class="ttdeci">uint32 getNumMCChannels() const </div><div class="ttdoc">Returns the total number of detected memory channels on all integrated memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:180</div></div>
<div class="ttc" id="classSystemCounterState_html_a6bdb34d102d7353421bd878da7b9ef23"><div class="ttname"><a href="classSystemCounterState.html#a6bdb34d102d7353421bd878da7b9ef23">SystemCounterState::getOutgoingQPILinkBytes</a></div><div class="ttdeci">friend uint64 getOutgoingQPILinkBytes(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of QPI (data+nondata) traffic per outgoing QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1971</div></div>
<div class="ttc" id="classPCM_html_a88584813a3ef51376efeb22928764786ac092b2b5f351e33046b87e5cee31f38f"><div class="ttname"><a href="classPCM.html#a88584813a3ef51376efeb22928764786ac092b2b5f351e33046b87e5cee31f38f">PCM::CUSTOM_CORE_EVENTS</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:314</div></div>
<div class="ttc" id="classPCM_html_aad05d8a2f383ad41d25892175373b613"><div class="ttname"><a href="classPCM.html#aad05d8a2f383ad41d25892175373b613">PCM::isPackageCStateResidencySupported</a></div><div class="ttdeci">bool isPackageCStateResidencySupported(int state)</div><div class="ttdoc">Returns true if the specified package C-state residency metric is supported. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:279</div></div>
<div class="ttc" id="classUncoreCounterState_html_a71af0766460ef7dd3d138ec0d0924eda"><div class="ttname"><a href="classUncoreCounterState.html#a71af0766460ef7dd3d138ec0d0924eda">UncoreCounterState::getDRAMConsumedEnergy</a></div><div class="ttdeci">friend uint64 getDRAMConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by DRAM (measured in internal units) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1146</div></div>
<div class="ttc" id="classCoreCounterState_html"><div class="ttname"><a href="classCoreCounterState.html">CoreCounterState</a></div><div class="ttdoc">(Logical) core-wide counter state </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1277</div></div>
<div class="ttc" id="cpucounters_8h_html_a459367d7877d09594c2ecd85e04cae61"><div class="ttname"><a href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a></div><div class="ttdeci">uint64 getL2CacheHits(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L2 cache hits. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1719</div></div>
<div class="ttc" id="classPCM_html_a617df842e3f4ef9088bc09c62d7c5cd2"><div class="ttname"><a href="classPCM.html#a617df842e3f4ef9088bc09c62d7c5cd2">PCM::isCoreOnline</a></div><div class="ttdeci">bool isCoreOnline(int32 os_core_id) const </div><div class="ttdoc">Return true if the core in online. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:1256</div></div>
<div class="ttc" id="cpucounters_8h_html_ac26765efe8a4c7341f40c8ab8bdb9af6"><div class="ttname"><a href="cpucounters_8h.html#ac26765efe8a4c7341f40c8ab8bdb9af6">getCyclesLostDueL2CacheMisses</a></div><div class="ttdeci">double getCyclesLostDueL2CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Estimates how many core cycles were potentially lost due to missing L2 cache but still hitting L3 cac...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1614</div></div>
<div class="ttc" id="classPCM_html_a57f04203c6bef6f9fcdf489c6fea9089"><div class="ttname"><a href="classPCM.html#a57f04203c6bef6f9fcdf489c6fea9089">PCM::getMCPerSocket</a></div><div class="ttdeci">uint32 getMCPerSocket() const </div><div class="ttdoc">Returns the number of detected integrated memory controllers per socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:661</div></div>
<div class="ttc" id="classBasicCounterState_html_a5a3275c4f489a475f1658f4546567af4"><div class="ttname"><a href="classBasicCounterState.html#a5a3275c4f489a475f1658f4546567af4">BasicCounterState::getCycles</a></div><div class="ttdeci">friend uint64 getCycles(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number core clock cycles when signal on a specific core is running (not halted) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1449</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_acf1af9c95ce0d0d0cd8940a38866a639"><div class="ttname"><a href="classServerPCICFGUncore.html#acf1af9c95ce0d0d0cd8940a38866a639">ServerPCICFGUncore::getNumMC</a></div><div class="ttdeci">uint32 getNumMC() const </div><div class="ttdoc">Returns the number of detected integrated memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:177</div></div>
<div class="ttc" id="cpucounters_8h_html_a0f28a32a3edeaecd916ba097aee99d7f"><div class="ttname"><a href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a></div><div class="ttdeci">uint64 getBytesReadFromMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes read from DRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1838</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a0c49b159e5bdf999d3c14cfcba51136b"><div class="ttname"><a href="classServerPCICFGUncore.html#a0c49b159e5bdf999d3c14cfcba51136b">ServerPCICFGUncore::getOutgoingDataNonDataFlits</a></div><div class="ttdeci">uint64 getOutgoingDataNonDataFlits(uint32 port)</div><div class="ttdoc">Get the number of outgoing data and non-data flits from the socket through a port. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3709</div></div>
<div class="ttc" id="classBasicCounterState_html_a963d78be64ccddb4f7686405ef4df9c1"><div class="ttname"><a href="classBasicCounterState.html#a963d78be64ccddb4f7686405ef4df9c1">BasicCounterState::getActiveAverageFrequency</a></div><div class="ttdeci">friend double getActiveAverageFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency when not in powersaving C0-state (also taking Intel Turbo Boost techn...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1544</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a3b218ad26a3c6411754ed177427b2a80"><div class="ttname"><a href="classServerPCICFGUncore.html#a3b218ad26a3c6411754ed177427b2a80">ServerPCICFGUncore::getDRAMClocks</a></div><div class="ttdeci">uint64 getDRAMClocks(uint32 channel)</div><div class="ttdoc">Get number DRAM channel cycles. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3891</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_aa0ac63963af6105dd066f09beb923d17"><div class="ttname"><a href="classServerPCICFGUncore.html#aa0ac63963af6105dd066f09beb923d17">ServerPCICFGUncore::getQPIL1Cycles</a></div><div class="ttdeci">uint64 getQPIL1Cycles(uint32 port)</div><div class="ttdoc">Get number cycles on a QPI port when the link was in a power saving shutdown mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3879</div></div>
<div class="ttc" id="cpucounters_8h_html_a546944a165ea621d77a524b15ccd6cf1"><div class="ttname"><a href="cpucounters_8h.html#a546944a165ea621d77a524b15ccd6cf1">getTotalExecUsage</a></div><div class="ttdeci">double getTotalExecUsage(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per time intervall for the entire system combining in...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1511</div></div>
<div class="ttc" id="classPCM_html_a5e5450e5ce7c995410d7ac7e6e1cb1a4"><div class="ttname"><a href="classPCM.html#a5e5450e5ce7c995410d7ac7e6e1cb1a4">PCM::getMaxIPC</a></div><div class="ttdeci">uint32 getMaxIPC() const </div><div class="ttdoc">Returns the max number of instructions per cycle. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:702</div></div>
<div class="ttc" id="classBasicCounterState_html_a7ba16714ef7ed547ad8648cb5b9e52f6"><div class="ttname"><a href="classBasicCounterState.html#a7ba16714ef7ed547ad8648cb5b9e52f6">BasicCounterState::getL3CacheHits</a></div><div class="ttdeci">friend uint64 getL3CacheHits(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes total number of L3 cache hits. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1767</div></div>
<div class="ttc" id="classBasicCounterState_html_abaa9d828b52f41866bf7dc8ff491a62e"><div class="ttname"><a href="classBasicCounterState.html#abaa9d828b52f41866bf7dc8ff491a62e">BasicCounterState::getNumberOfCustomEvents</a></div><div class="ttdeci">friend uint64 getNumberOfCustomEvents(int32 eventCounterNr, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of occured custom core events. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1877</div></div>
<div class="ttc" id="msr_8h_html"><div class="ttname"><a href="msr_8h.html">msr.h</a></div><div class="ttdoc">Low level interface to access hardware model specific registers. </div></div>
<div class="ttc" id="classPCM_html_a9db0d472d9cdc0aa3c6db8ed7bb38f77"><div class="ttname"><a href="classPCM.html#a9db0d472d9cdc0aa3c6db8ed7bb38f77">PCM::getServerUncorePowerState</a></div><div class="ttdeci">ServerUncorePowerState getServerUncorePowerState(uint32 socket)</div><div class="ttdoc">Reads the power/energy counter state of a socket (works only on microarchitecture codename SandyBridg...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3144</div></div>
<div class="ttc" id="classPCM_html_abebf5f22d794719dfc49155741e264e5"><div class="ttname"><a href="classPCM.html#abebf5f22d794719dfc49155741e264e5">PCM::ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Return codes (e.g. for program(..) method) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:320</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a214de12b52f2d5a7c9c33701dfc8eb85"><div class="ttname"><a href="classServerPCICFGUncore.html#a214de12b52f2d5a7c9c33701dfc8eb85">ServerPCICFGUncore::getImcReads</a></div><div class="ttdeci">uint64 getImcReads()</div><div class="ttdoc">Get the number of integrated controller reads (in cache lines) </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3668</div></div>
<div class="ttc" id="classPCM_html_a155611028fb95409625e44784f7b4c7b"><div class="ttname"><a href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a></div><div class="ttdeci">static PCM * getInstance()</div><div class="ttdoc">Returns PCM object. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:196</div></div>
<div class="ttc" id="classBasicCounterState_html"><div class="ttname"><a href="classBasicCounterState.html">BasicCounterState</a></div><div class="ttdoc">Basic core counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:910</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_abaeb0a56fa35ecbd0c092b733a1f923b"><div class="ttname"><a href="classServerPCICFGUncore.html#abaeb0a56fa35ecbd0c092b733a1f923b">ServerPCICFGUncore::getIncomingDataFlits</a></div><div class="ttdeci">uint64 getIncomingDataFlits(uint32 port)</div><div class="ttdoc">Get the number of incoming data flits to the socket through a port. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3696</div></div>
<div class="ttc" id="cpucounters_8h_html_a17823150d51bdebdd203dfa00b0a5f49"><div class="ttname"><a href="cpucounters_8h.html#a17823150d51bdebdd203dfa00b0a5f49">getQPItoMCTrafficRatio</a></div><div class="ttdeci">double getQPItoMCTrafficRatio(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get QPI data to Memory Controller traffic ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2090</div></div>
<div class="ttc" id="classServerUncorePowerState_html_a580ae4e465d0f8dd93935ad7af28c095"><div class="ttname"><a href="classServerUncorePowerState.html#a580ae4e465d0f8dd93935ad7af28c095">ServerUncorePowerState::getQPIL1Cycles</a></div><div class="ttdeci">friend uint64 getQPIL1Cycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of QPI cycles in power saving shutdown mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1058</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Sep 2 2014 16:22:33 for Intel(r) Performance Counter Monitor by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
